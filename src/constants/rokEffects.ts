// Эффекты карт Рока для колоды Кассиана

export interface RokEffect {
  id: number;
  name: string;
  description: string;
  additionalRolls?: { dice: string; label: string }[];
  requiresSuccessCheck?: boolean;  // нужен доп d20 > 11
  isRecursive?: boolean;           // для эффекта 13 (рикошет)
  spawnsExtra?: number;            // для эффекта 17 (+2 карты)
}

export const ROK_EFFECTS: RokEffect[] = [
  { 
    id: 1, 
    name: "Стихийный хаос", 
    description: "Случайный элемент: 1-Огонь(поджог), 2-Вода(замедление), 3-Земля(оглушение), 4-Воздух(отбрасывание), 5-Свет(ослепление), 6-Тьма(страх), 7-Электричество(паралич), 8-Лёд(заморозка), 9-Природа(опутывание), 10-Пустота(вытягивание), 11-Скверна(отравление), 12-Смерть(некроз)", 
    additionalRolls: [{ dice: "d12", label: "Элемент" }] 
  },
    
  { 
    id: 2, 
    name: "Элементальный барьер",
    description: "Блокирует весь урон от случайного элемента (d12) на 1 раунд",
    additionalRolls: [{ dice: "d12", label: "Элемент барьера" }] 
  },
    
  { 
    id: 3, 
    name: "Конструкция",
    description: "Создаёт случайную постройку. Размер: 1-2 = маленькая, 3-4 = средняя, 5-6 = большая",
    additionalRolls: [{ dice: "d6", label: "Размер" }] 
  },
    
  { 
    id: 4, 
    name: "Исцеление",
    description: "Восстанавливает HP: множитель × за единицу",
    additionalRolls: [
      { dice: "d4", label: "Множитель" }, 
      { dice: "d12", label: "За единицу" }
    ] 
  },
    
  { 
    id: 5, 
    name: "Нежить",
    description: "Призывает бесконтрольную нежить. Чем выше бросок — тем сильнее",
    additionalRolls: [{ dice: "d20", label: "Сила нежити" }] 
  },
    
  { 
    id: 6, 
    name: "Чистый урон",
    description: "Наносит чистый урон (игнорирует броню): множитель × за единицу",
    additionalRolls: [
      { dice: "d4", label: "Множитель" }, 
      { dice: "d12", label: "За единицу" }
    ] 
  },
    
  { 
    id: 7, 
    name: "Перевёрнутый мир",
    description: "1 = удача, 20 = неудача. Действует на ВСЕХ в бою на 8 раундов" 
  },
    
  { 
    id: 8, 
    name: "Клон",
    description: "Создаёт точную копию цели (требуется проверка успеха d20 ≥ 11)",
    requiresSuccessCheck: true 
  },
    
  { 
    id: 9, 
    name: "Нестабильная аура",
    description: "Аура на 5 раундов: 1=взрыв предметов рядом, 2=+2 к силе, 3=2d20 электр.урона + повтор последнего урона, 4=становится союзником",
    additionalRolls: [{ dice: "d4", label: "Тип ауры" }] 
  },
    
  { 
    id: 10, 
    name: "Дикая магия",
    description: "Случайное заклинание: 1=Огненный шар, 2=Ледяная буря, 3=Молния, 4=Землетрясение, 5=Телепортация, 6=Невидимость, 7=Замедление времени, 8=Гравитационная волна, 9=Призыв элементаля, 10=Массовое исцеление",
    additionalRolls: [{ dice: "d10", label: "Заклинание" }] 
  },
    
  { 
    id: 11, 
    name: "Уязвимость",
    description: "Следующий урон по цели УДВОЕН (действует 1 раунд)" 
  },
    
  { 
    id: 12, 
    name: "Червоточина",
    description: "Открывается нестабильная червоточина в случайное место" 
  },
    
  { 
    id: 13, 
    name: "Рикошет",
    description: "Карта отскакивает в ближайшее существо, повторяя бросок эффекта!",
    isRecursive: true 
  },
    
  { 
    id: 14, 
    name: "Неуязвимость",
    description: "Отменяет ВЕСЬ урон — и уже полученный в этом раунде, и будущий до конца раунда" 
  },
    
  { 
    id: 15, 
    name: "Мутация",
    description: "Характеристика (d6): 1=Сила, 2=Ловкость, 3=Живучесть, 4=Интеллект, 5=Харизма, 6=Инициатива. d20 < 11 = −10, d20 ≥ 11 = +10. Длится 3 раунда",
    additionalRolls: [
      { dice: "d6", label: "Характеристика" }, 
      { dice: "d20", label: "Улучшение/Ухудшение" }
    ] 
  },
    
  { 
    id: 16, 
    name: "Ярость",
    description: "Цель впадает в ярость: +20 к урону, +40 к максимальному здоровью" 
  },
    
  { 
    id: 17, 
    name: "Раздвоение",
    description: "БОНУС! +2 дополнительные карты вылетают БЕСПЛАТНО (не из колоды)!",
    spawnsExtra: 2 
  },
    
  { 
    id: 18, 
    name: "Портал",
    description: "Открывается портал в измерение: 1=Ад, 2=Пустота, 3=Ледяные пустоши, 4=Эфир, 5=Мир мёртвых, 6=Царство кошмаров, 7=Скверна, 8=Облачные чертоги",
    additionalRolls: [{ dice: "d8", label: "Измерение" }] 
  },
    
  { 
    id: 19, 
    name: "Страх",
    description: "Цель охватывает ужас — пытается сбежать из боя (если поддаётся страху)" 
  },
    
  { 
    id: 20, 
    name: "Обмен HP",
    description: "Текущее здоровье цели и кастера ОБМЕНИВАЮТСЯ на 6 раундов (d20 ≥ 11 = успех)",
    requiresSuccessCheck: true 
  }
];

// Получить эффект по броску d20
export function getRokEffect(roll: number): RokEffect {
  // roll от 1 до 20, индекс от 0 до 19
  const index = Math.max(0, Math.min(19, roll - 1));
  return ROK_EFFECTS[index]!;
}

// Названия элементов для d12
export const ELEMENT_NAMES: Record<number, string> = {
  1: 'Огонь',
  2: 'Вода',
  3: 'Земля',
  4: 'Воздух',
  5: 'Свет',
  6: 'Тьма',
  7: 'Электричество',
  8: 'Лёд',
  9: 'Природа',
  10: 'Пустота',
  11: 'Скверна',
  12: 'Смерть'
};

// Названия измерений для d8
export const DIMENSION_NAMES: Record<number, string> = {
  1: 'Ад',
  2: 'Пустота',
  3: 'Ледяные пустоши',
  4: 'Эфир',
  5: 'Мир мёртвых',
  6: 'Царство кошмаров',
  7: 'Скверна',
  8: 'Облачные чертоги'
};

// Названия характеристик для d6
export const STAT_MUTATION_NAMES: Record<number, string> = {
  1: 'Сила',
  2: 'Ловкость',
  3: 'Живучесть',
  4: 'Интеллект',
  5: 'Харизма',
  6: 'Инициатива'
};
