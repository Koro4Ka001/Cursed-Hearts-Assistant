/* ═══════════════════════════════════════════════════════════════
   CURSED HEARTS ASSISTANT — Dark Grimoire Theme v2
   Тёмная кожа гримуара с золотыми рунами и кровавыми акцентами
   ═══════════════════════════════════════════════════════════════ */

@import "tailwindcss";

/* ── Tailwind 4 Theme ─────────────────────────────────────────── */
@theme {
  --color-abyss: #0a0a0f;
  --color-dark: #111118;
  --color-obsidian: #1a1a24;
  --color-panel: #14141e;
  --color-bone: #d4c8a8;
  --color-faded: #8a7e66;
  --color-dim: #5a5040;
  --color-gold: #c8a84e;
  --color-gold-bright: #e8d068;
  --color-gold-dark: #7a5a1e;
  --color-blood: #8b1a1a;
  --color-blood-bright: #cc2222;
  --color-blood-dark: #4a0a0a;
  --color-mana: #2a5a8a;
  --color-mana-bright: #4499dd;
  --color-mana-dark: #1a2a3a;
  --color-ancient: #7a6a4a;
  --color-edge-bone: #2a2520;
  --font-cinzel: 'Cinzel', serif;
  --font-cinzel-decorative: 'Cinzel Decorative', serif;
  --font-garamond: 'EB Garamond', serif;
  --font-medieval: 'MedievalSharp', cursive;
}

/* ══════════════════════════════════════════════════════════════
   BASE
   ══════════════════════════════════════════════════════════════ */

*, *::before, *::after { box-sizing: border-box; }

html, body, #root {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

body {
  background: var(--color-abyss);
  color: var(--color-bone);
  font-family: var(--font-garamond);
  -webkit-font-smoothing: antialiased;
}

/* ── Scrollbar ──────────────────────────────────────────────── */
::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-track { background: var(--color-abyss); }
::-webkit-scrollbar-thumb { background: var(--color-gold-dark); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: var(--color-gold); }

::selection {
  background: rgba(200, 168, 78, 0.3);
  color: var(--color-gold-bright);
}

.heading { font-family: var(--font-cinzel); font-weight: 700; letter-spacing: 0.05em; }
.heading-decorative { font-family: var(--font-cinzel-decorative); font-weight: 700; }

/* ══════════════════════════════════════════════════════════════
   APP FRAME — Текстура кожи гримуара
   ══════════════════════════════════════════════════════════════ */

.app-frame {
  position: relative;
  background:
    /* Тонкая «кожаная» текстура */
    repeating-linear-gradient(
      0deg,
      transparent,
      rgba(200,168,78,0.008) 1px,
      transparent 2px
    ),
    repeating-linear-gradient(
      90deg,
      transparent,
      rgba(200,168,78,0.005) 1px,
      transparent 3px
    ),
    /* Цветовые пятна */
    radial-gradient(ellipse at 20% 0%, rgba(200,168,78,0.06) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 100%, rgba(42,90,138,0.04) 0%, transparent 50%),
    radial-gradient(ellipse at 50% 50%, rgba(139,26,26,0.03) 0%, transparent 60%),
    /* Основной градиент */
    linear-gradient(180deg, #0e0e16 0%, #0a0a0f 40%, #080810 100%);
  /* Золотая рамка */
  border: 1px solid rgba(200,168,78,0.15);
  box-shadow: inset 0 0 30px rgba(0,0,0,0.5);
}

/* ══════════════════════════════════════════════════════════════
   FLOATING RUNES — Мерцающие руны на фоне (ЯРКИЕ!)
   ══════════════════════════════════════════════════════════════ */

.bg-runes {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  overflow: hidden;
}

.bg-rune {
  position: absolute;
  color: var(--color-gold);
  opacity: 0;
  animation: rune-drift 12s infinite ease-in-out;
  user-select: none;
  filter: blur(0.5px);
  text-shadow: 0 0 8px rgba(200,168,78,0.4);
}

.bg-rune:nth-child(1) { top: 5%; left: 5%; font-size: 32px; animation-delay: 0s; animation-duration: 15s; }
.bg-rune:nth-child(2) { top: 20%; right: 8%; font-size: 24px; animation-delay: 2s; animation-duration: 18s; }
.bg-rune:nth-child(3) { top: 45%; left: 8%; font-size: 20px; animation-delay: 5s; animation-duration: 14s; }
.bg-rune:nth-child(4) { top: 65%; right: 12%; font-size: 26px; animation-delay: 8s; animation-duration: 16s; }
.bg-rune:nth-child(5) { top: 35%; left: 75%; font-size: 18px; animation-delay: 3s; animation-duration: 20s; }
.bg-rune:nth-child(6) { top: 85%; left: 35%; font-size: 22px; animation-delay: 10s; animation-duration: 17s; }
.bg-rune:nth-child(7) { top: 10%; left: 50%; font-size: 16px; animation-delay: 7s; animation-duration: 13s; }
.bg-rune:nth-child(8) { top: 55%; right: 5%; font-size: 20px; animation-delay: 12s; animation-duration: 19s; }

@keyframes rune-drift {
  0%, 100% { opacity: 0; transform: translateY(0) rotate(0deg) scale(0.8); }
  15% { opacity: 0.12; }
  50% { opacity: 0.2; transform: translateY(-20px) rotate(8deg) scale(1); text-shadow: 0 0 15px rgba(200,168,78,0.6); }
  85% { opacity: 0.12; }
}

/* Руны на экране загрузки — ещё ярче */
.loading-rune {
  position: absolute;
  font-size: 28px;
  color: var(--color-gold);
  opacity: 0;
  animation: loading-rune-pulse 3s infinite ease-in-out;
  user-select: none;
  text-shadow: 0 0 12px rgba(200,168,78,0.5);
}

@keyframes loading-rune-pulse {
  0%, 100% { opacity: 0.05; transform: scale(0.9); }
  50% { opacity: 0.3; transform: scale(1.1); text-shadow: 0 0 20px rgba(200,168,78,0.8); }
}

/* ══════════════════════════════════════════════════════════════
   EMBERS — Тлеющие угольки (ЯРКИЕ!)
   ══════════════════════════════════════════════════════════════ */

.ember {
  position: absolute;
  border-radius: 50%;
  pointer-events: none;
}

.ember-1 {
  bottom: 15%; left: 12%;
  width: 4px; height: 4px;
  background: #ff6600;
  box-shadow: 0 0 8px 3px rgba(255,102,0,0.7), 0 0 20px 5px rgba(255,68,0,0.3);
  animation: ember-float 7s infinite ease-in-out;
}

.ember-2 {
  bottom: 35%; right: 18%;
  width: 3px; height: 3px;
  background: #ff4400;
  box-shadow: 0 0 6px 2px rgba(255,68,0,0.6), 0 0 15px 4px rgba(255,34,0,0.25);
  animation: ember-float 10s infinite ease-in-out 2s;
}

.ember-3 {
  bottom: 55%; left: 55%;
  width: 3px; height: 3px;
  background: #ff8800;
  box-shadow: 0 0 6px 2px rgba(255,136,0,0.6), 0 0 15px 3px rgba(255,102,0,0.2);
  animation: ember-float 8s infinite ease-in-out 4s;
}

.ember-4 {
  bottom: 25%; left: 40%;
  width: 2px; height: 2px;
  background: #ffaa00;
  box-shadow: 0 0 5px 2px rgba(255,170,0,0.5);
  animation: ember-float 12s infinite ease-in-out 1s;
}

.ember-5 {
  bottom: 70%; right: 30%;
  width: 2px; height: 2px;
  background: #ff5500;
  box-shadow: 0 0 4px 2px rgba(255,85,0,0.5);
  animation: ember-float 9s infinite ease-in-out 6s;
}

@keyframes ember-float {
  0% { opacity: 0; transform: translateY(0) translateX(0); }
  10% { opacity: 1; }
  40% { opacity: 0.7; }
  70% { opacity: 0.9; transform: translateY(-60px) translateX(15px); }
  100% { opacity: 0; transform: translateY(-80px) translateX(-10px); }
}

/* ══════════════════════════════════════════════════════════════
   VIGNETTE + GOLD DUST
   ══════════════════════════════════════════════════════════════ */

.app-vignette {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  background: radial-gradient(ellipse at center, transparent 40%, rgba(0,0,0,0.6) 100%);
}

.gold-dust {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  background-image:
    radial-gradient(1px 1px at 20% 30%, rgba(200,168,78,0.3) 0%, transparent 100%),
    radial-gradient(1px 1px at 60% 20%, rgba(200,168,78,0.2) 0%, transparent 100%),
    radial-gradient(1px 1px at 80% 60%, rgba(200,168,78,0.25) 0%, transparent 100%),
    radial-gradient(1px 1px at 40% 80%, rgba(200,168,78,0.15) 0%, transparent 100%),
    radial-gradient(1px 1px at 10% 70%, rgba(200,168,78,0.2) 0%, transparent 100%),
    radial-gradient(1px 1px at 90% 40%, rgba(200,168,78,0.15) 0%, transparent 100%);
  animation: dust-shimmer 8s ease-in-out infinite alternate;
}

@keyframes dust-shimmer {
  0% { opacity: 0.3; }
  100% { opacity: 0.7; }
}

/* ══════════════════════════════════════════════════════════════
   SCREEN EFFECTS
   ══════════════════════════════════════════════════════════════ */

.screen-shake { animation: shake 0.5s ease-out; }

@keyframes shake {
  0%, 100% { transform: translate(0); }
  10% { transform: translate(-5px, 3px); }
  20% { transform: translate(5px, -3px); }
  30% { transform: translate(-4px, 2px); }
  40% { transform: translate(4px, -2px); }
  50% { transform: translate(-2px, 1px); }
}

.screen-flash-gold { animation: flash-gold 0.7s ease-out; }

@keyframes flash-gold {
  0% { box-shadow: inset 0 0 100px rgba(232,208,104,0.6); }
  30% { box-shadow: inset 0 0 150px rgba(232,208,104,0.3); }
  100% { box-shadow: inset 0 0 0 transparent; }
}

.screen-flash-blood { animation: flash-blood 0.7s ease-out; }

@keyframes flash-blood {
  0% { box-shadow: inset 0 0 80px rgba(204,34,34,0.6); }
  50% { box-shadow: inset 0 0 120px rgba(139,26,26,0.3); }
  100% { box-shadow: inset 0 0 0 transparent; }
}

.screen-heal-glow { animation: heal-glow 0.7s ease-out; }

@keyframes heal-glow {
  0% { box-shadow: inset 0 0 60px rgba(34,204,68,0.5); }
  50% { box-shadow: inset 0 0 100px rgba(34,204,68,0.2); }
  100% { box-shadow: inset 0 0 0 transparent; }
}

/* ══════════════════════════════════════════════════════════════
   HP VESSEL — Сосуд с кровью
   ══════════════════════════════════════════════════════════════ */

.hp-vessel {
  position: relative;
  height: 28px;
  border-radius: 14px;
  overflow: hidden;
  border: 1px solid #4a1515;
  box-shadow: 0 0 8px rgba(139,26,26,0.3), inset 0 1px 3px rgba(0,0,0,0.5);
  transition: box-shadow 0.3s;
}

.hp-vessel-low {
  animation: vessel-pulse 1.5s ease-in-out infinite;
  border-color: #cc2222;
  box-shadow: 0 0 12px rgba(204,34,34,0.4), 0 0 24px rgba(204,34,34,0.15), inset 0 1px 3px rgba(0,0,0,0.5);
}

@keyframes vessel-pulse {
  0%, 100% { box-shadow: 0 0 12px rgba(204,34,34,0.4), inset 0 1px 3px rgba(0,0,0,0.5); }
  50% { box-shadow: 0 0 25px rgba(204,34,34,0.7), 0 0 40px rgba(204,34,34,0.2), inset 0 1px 3px rgba(0,0,0,0.5); }
}

.hp-vessel-bg {
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, #1a0808 0%, #2a0e0e 50%, #1a0808 100%);
}

.hp-vessel-fill {
  position: absolute;
  left: 0; top: 0; bottom: 0;
  background: linear-gradient(180deg, #cc2222 0%, #aa1a1a 30%, #881414 60%, #660e0e 100%);
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
  border-radius: 14px;
}

/* Пузырьки крови */
.hp-bubble {
  position: absolute;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(255,100,100,0.6) 0%, transparent 70%);
  animation: bubble-rise linear infinite;
  pointer-events: none;
}

.hp-bubble-1 { width: 4px; height: 4px; left: 20%; bottom: -4px; animation-duration: 3s; }
.hp-bubble-2 { width: 3px; height: 3px; left: 45%; bottom: -3px; animation-duration: 4s; animation-delay: 1s; }
.hp-bubble-3 { width: 5px; height: 5px; left: 65%; bottom: -5px; animation-duration: 3.5s; animation-delay: 0.5s; }
.hp-bubble-4 { width: 3px; height: 3px; left: 80%; bottom: -3px; animation-duration: 4.5s; animation-delay: 2s; }
.hp-bubble-5 { width: 2px; height: 2px; left: 35%; bottom: -2px; animation-duration: 3.2s; animation-delay: 1.5s; }

@keyframes bubble-rise {
  0% { transform: translateY(0) scale(1); opacity: 0; }
  10% { opacity: 0.7; }
  80% { opacity: 0.3; }
  100% { transform: translateY(-28px) scale(0.5); opacity: 0; }
}

/* Блики */
.hp-vessel-shine {
  position: absolute;
  top: 2px; left: 10%; right: 30%; height: 4px;
  background: linear-gradient(90deg, transparent, rgba(255,180,180,0.25), transparent);
  border-radius: 4px;
}

.hp-vessel-shine-2 {
  position: absolute;
  top: 4px; left: 50%; width: 20%; height: 2px;
  background: rgba(255,200,200,0.15);
  border-radius: 2px;
}

/* Текст */
.hp-vessel-label {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center; gap: 3px;
  font-family: var(--font-cinzel); font-size: 12px; font-weight: 700;
  color: #fff;
  text-shadow: 0 1px 4px rgba(0,0,0,0.8), 0 0 8px rgba(0,0,0,0.5);
  z-index: 5; letter-spacing: 0.5px;
}

.hp-vessel-icon {
  font-size: 11px;
  animation: heartbeat 2s ease-in-out infinite;
  filter: drop-shadow(0 0 4px rgba(255,50,50,0.6));
}

@keyframes heartbeat {
  0%, 100% { transform: scale(1); }
  15% { transform: scale(1.2); }
  30% { transform: scale(1); }
  45% { transform: scale(1.15); }
}

.hp-vessel-separator { opacity: 0.5; font-size: 10px; }

/* Капли крови */
.hp-drip-1, .hp-drip-2 {
  position: absolute;
  bottom: -10px; width: 3px; height: 10px;
  background: linear-gradient(180deg, #cc2222, transparent);
  border-radius: 0 0 3px 3px;
  animation: drip 2s ease-in infinite;
  z-index: 6;
}

.hp-drip-1 { left: 25%; }
.hp-drip-2 { left: 70%; animation-delay: 1s; }

@keyframes drip {
  0%, 60% { opacity: 0; transform: scaleY(0); }
  70% { opacity: 0.8; transform: scaleY(1); }
  100% { opacity: 0; transform: scaleY(1) translateY(15px); }
}

/* ══════════════════════════════════════════════════════════════
   MANA CRYSTAL — Кристалл маны
   ══════════════════════════════════════════════════════════════ */

.mana-crystal {
  position: relative;
  height: 24px;
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid #1a3a5a;
  box-shadow: 0 0 10px rgba(68,153,221,0.2), inset 0 1px 3px rgba(0,0,0,0.5);
}

.mana-crystal-bg {
  position: absolute; inset: 0;
  background: linear-gradient(180deg, #0a1520 0%, #0e1a28 50%, #0a1520 100%);
}

.mana-crystal-fill {
  position: absolute; left: 0; top: 0; bottom: 0;
  background: linear-gradient(180deg, #4499dd 0%, #3377bb 30%, #2a5a8a 60%, #1e4468 100%);
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
  border-radius: 12px;
}

/* Искры */
.mana-spark {
  position: absolute;
  width: 2px; height: 2px; border-radius: 50%;
  background: #88ccff;
  box-shadow: 0 0 4px 1px rgba(136,204,255,0.6);
  animation: spark-drift linear infinite;
  pointer-events: none;
}

.mana-spark-1 { top: 30%; left: 15%; animation-duration: 2.5s; }
.mana-spark-2 { top: 60%; left: 35%; animation-duration: 3s; animation-delay: 0.5s; width: 1px; height: 1px; }
.mana-spark-3 { top: 20%; left: 55%; animation-duration: 2.8s; animation-delay: 1s; }
.mana-spark-4 { top: 70%; left: 70%; animation-duration: 3.2s; animation-delay: 1.5s; width: 1px; height: 1px; }
.mana-spark-5 { top: 40%; left: 85%; animation-duration: 2.6s; animation-delay: 0.8s; }
.mana-spark-6 { top: 50%; left: 25%; animation-duration: 3.5s; animation-delay: 2s; width: 1px; height: 1px; }

@keyframes spark-drift {
  0% { opacity: 0; transform: translate(0, 0) scale(0); }
  20% { opacity: 1; transform: translate(2px, -2px) scale(1); }
  80% { opacity: 0.6; transform: translate(-3px, 3px) scale(0.8); }
  100% { opacity: 0; transform: translate(5px, -5px) scale(0); }
}

/* Бегущий блик */
.mana-crystal-shimmer {
  position: absolute; top: 0; left: -40%;
  width: 30%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(136,204,255,0.2), transparent);
  animation: shimmer-run 4s ease-in-out infinite;
  transform: skewX(-20deg);
}

@keyframes shimmer-run {
  0%, 100% { left: -40%; opacity: 0; }
  10% { opacity: 1; }
  90% { opacity: 1; }
  100% { left: 140%; opacity: 0; }
}

.mana-crystal-shine {
  position: absolute; top: 2px; left: 15%;
  width: 25%; height: 3px;
  background: linear-gradient(90deg, transparent, rgba(136,204,255,0.25), transparent);
  border-radius: 3px;
}

.mana-crystal-label {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center; gap: 3px;
  font-family: var(--font-cinzel); font-size: 11px; font-weight: 700;
  color: #d0e8ff;
  text-shadow: 0 1px 4px rgba(0,0,0,0.8), 0 0 6px rgba(68,153,221,0.3);
  z-index: 5; letter-spacing: 0.5px;
}

.mana-crystal-icon {
  font-size: 10px;
  animation: crystal-glow 3s ease-in-out infinite;
  filter: drop-shadow(0 0 4px rgba(68,153,221,0.6));
}

@keyframes crystal-glow {
  0%, 100% { filter: drop-shadow(0 0 4px rgba(68,153,221,0.4)); }
  50% { filter: drop-shadow(0 0 10px rgba(68,153,221,0.9)); }
}

.mana-crystal-separator { opacity: 0.4; font-size: 9px; }

/* ══════════════════════════════════════════════════════════════
   BUTTONS — Рунные печати
   ══════════════════════════════════════════════════════════════ */

.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 6px;
  padding: 8px 16px; border-radius: 6px;
  font-family: var(--font-cinzel); font-size: 12px; font-weight: 700;
  letter-spacing: 0.04em;
  border: 1px solid transparent;
  cursor: pointer; transition: all 0.2s;
  position: relative; overflow: hidden;
  text-transform: uppercase;
}

.btn:active { transform: scale(0.97); }
.btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }

/* Gold */
.btn-gold {
  background: linear-gradient(180deg, #2a1e0a 0%, #1e1508 100%);
  border-color: var(--color-gold-dark);
  color: var(--color-gold-bright);
}

.btn-gold:hover:not(:disabled) {
  border-color: var(--color-gold);
  box-shadow: 0 0 16px rgba(200,168,78,0.4), inset 0 0 16px rgba(200,168,78,0.06);
  color: #fff;
  text-shadow: 0 0 8px rgba(200,168,78,0.5);
}

/* Blood/Danger */
.btn-blood, .btn-danger {
  background: linear-gradient(180deg, #2a0a0a 0%, #1a0505 100%);
  border-color: #4a1515;
  color: var(--color-blood-bright);
}

.btn-blood:hover:not(:disabled), .btn-danger:hover:not(:disabled) {
  border-color: var(--color-blood-bright);
  box-shadow: 0 0 16px rgba(204,34,34,0.4);
  color: #ff6666;
  text-shadow: 0 0 8px rgba(204,34,34,0.5);
}

/* Success */
.btn-success {
  background: linear-gradient(180deg, #0a2a0a 0%, #051a05 100%);
  border-color: #1a4a1a;
  color: #44cc44;
}

.btn-success:hover:not(:disabled) {
  border-color: #44cc44;
  box-shadow: 0 0 16px rgba(68,204,68,0.3);
  text-shadow: 0 0 8px rgba(68,204,68,0.5);
}

/* Secondary */
.btn-secondary {
  background: linear-gradient(180deg, #1e1e28 0%, #14141e 100%);
  border-color: var(--color-edge-bone);
  color: var(--color-faded);
}

.btn-secondary:hover:not(:disabled) {
  border-color: var(--color-ancient);
  color: var(--color-bone);
  box-shadow: 0 0 8px rgba(122,106,74,0.2);
}

/* Mana */
.btn-mana {
  background: linear-gradient(180deg, #0e1a2a 0%, #0a1420 100%);
  border-color: #1a3a5a;
  color: var(--color-mana-bright);
}

.btn-mana:hover:not(:disabled) {
  border-color: var(--color-mana-bright);
  box-shadow: 0 0 16px rgba(68,153,221,0.3);
}

/* ══════════════════════════════════════════════════════════════
   PANELS & SECTIONS
   ══════════════════════════════════════════════════════════════ */

.panel {
  background: linear-gradient(180deg, rgba(20,20,30,0.9) 0%, rgba(14,14,20,0.95) 100%);
  border: 1px solid rgba(200,168,78,0.12);
  border-radius: 8px;
  position: relative;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(200,168,78,0.03);
}

/* Декоративные ромбы */
.panel::before, .panel::after {
  content: '◆';
  position: absolute;
  font-size: 6px;
  color: var(--color-gold-dark);
  opacity: 0.4;
}

.panel::before { top: -3px; left: 12px; }
.panel::after { bottom: -3px; right: 12px; }

.section-header {
  display: flex; align-items: center; gap: 8px;
  padding: 8px 12px;
  font-family: var(--font-cinzel); font-size: 12px; font-weight: 700;
  letter-spacing: 0.06em; text-transform: uppercase;
  color: var(--color-gold);
  cursor: pointer; user-select: none;
  transition: color 0.2s;
}

.section-header:hover { color: var(--color-gold-bright); text-shadow: 0 0 6px rgba(200,168,78,0.3); }

/* ══════════════════════════════════════════════════════════════
   TABS
   ══════════════════════════════════════════════════════════════ */

.tab-active {
  color: var(--color-gold-bright);
  background: linear-gradient(180deg, rgba(200,168,78,0.1) 0%, transparent 100%);
  text-shadow: 0 0 10px rgba(200,168,78,0.5);
}

.tab-inactive { color: var(--color-faded); opacity: 0.6; }
.tab-inactive:hover { opacity: 1; color: var(--color-bone); background: rgba(255,255,255,0.03); }

/* Золотой ромбик */
.tab-rune { position: relative; }

.tab-active.tab-rune::after {
  content: '';
  position: absolute; bottom: -1px; left: 50%;
  transform: translateX(-50%) rotate(45deg);
  width: 7px; height: 7px;
  background: var(--color-gold);
  box-shadow: 0 0 8px rgba(200,168,78,0.6);
  z-index: 10;
}

/* Золотая линия под активной */
.tab-active.tab-rune::before {
  content: '';
  position: absolute; bottom: 0; left: 10%; right: 10%;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--color-gold-dark), transparent);
  z-index: 9;
}

.tab-content-enter { animation: tab-enter 0.3s ease-out; }

@keyframes tab-enter {
  0% { opacity: 0; transform: translateY(8px); }
  100% { opacity: 1; transform: translateY(0); }
}

/* Sub tabs */
.sub-tab {
  padding: 6px 12px;
  font-family: var(--font-cinzel); font-size: 10px; font-weight: 700;
  letter-spacing: 0.06em; text-transform: uppercase;
  border-radius: 4px;
  border: 1px solid transparent;
  cursor: pointer; transition: all 0.2s;
  color: var(--color-faded); background: transparent;
}

.sub-tab:hover { color: var(--color-bone); background: rgba(255,255,255,0.03); }

.sub-tab-active {
  color: var(--color-gold-bright) !important;
  border-color: var(--color-gold-dark);
  background: rgba(200,168,78,0.08) !important;
  box-shadow: 0 0 8px rgba(200,168,78,0.15);
}

/* ══════════════════════════════════════════════════════════════
   STATUS BAR
   ══════════════════════════════════════════════════════════════ */

.status-bar {
  height: 24px;
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 12px;
  background: linear-gradient(180deg, rgba(14,14,20,0.95), rgba(10,10,15,0.98));
  border-top: 1px solid rgba(200,168,78,0.1);
  font-family: var(--font-cinzel);
  font-size: 9px; letter-spacing: 0.1em;
  text-transform: uppercase;
  flex-shrink: 0;
}

.status-dot { transition: color 0.3s; }
.status-online { color: #44cc44; text-shadow: 0 0 4px rgba(68,204,68,0.5); }
.status-offline { color: var(--color-blood-bright); }
.status-dim { color: var(--color-faded); }

/* ══════════════════════════════════════════════════════════════
   MODALS
   ══════════════════════════════════════════════════════════════ */

.modal-overlay {
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
  z-index: 100;
  display: flex; align-items: center; justify-content: center;
  padding: 16px;
  animation: modal-bg-in 0.2s ease-out;
}

@keyframes modal-bg-in { from { opacity: 0; } to { opacity: 1; } }

.modal-box {
  background: linear-gradient(180deg, #16161e 0%, #101018 100%);
  border: 1px solid rgba(200,168,78,0.15);
  border-radius: 12px;
  overflow: hidden;
  display: flex; flex-direction: column;
  max-height: 85vh; width: 100%;
  box-shadow: 0 0 40px rgba(0,0,0,0.6), 0 0 80px rgba(0,0,0,0.3), inset 0 1px 0 rgba(200,168,78,0.05);
  animation: modal-enter 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes modal-enter {
  from { opacity: 0; transform: scale(0.95) translateY(10px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}

.modal-head {
  display: flex; align-items: center;
  padding: 14px 16px;
  border-bottom: 1px solid rgba(200,168,78,0.1);
  background: rgba(200,168,78,0.03);
}

/* ══════════════════════════════════════════════════════════════
   TOAST NOTIFICATIONS
   ══════════════════════════════════════════════════════════════ */

.toast {
  background: linear-gradient(135deg, #1a1a24 0%, #14141e 100%);
  border: 1px solid var(--color-edge-bone);
  border-radius: 8px;
  padding: 10px 14px;
  font-size: 12px; font-family: var(--font-garamond);
  color: var(--color-bone);
  box-shadow: 0 4px 20px rgba(0,0,0,0.5);
  position: relative; overflow: hidden;
  animation: toast-in 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.toast::before {
  content: ''; position: absolute;
  left: 0; top: 0; bottom: 0; width: 3px;
}

.toast-success::before { background: linear-gradient(180deg, #44cc44, #228822); }
.toast-error::before { background: linear-gradient(180deg, #cc2222, #881414); }
.toast-warning::before { background: linear-gradient(180deg, #ccaa22, #886611); }
.toast-info::before { background: linear-gradient(180deg, #4499dd, #2266aa); }

@keyframes toast-in {
  from { opacity: 0; transform: translateX(20px) scale(0.95); }
  to { opacity: 1; transform: translateX(0) scale(1); }
}

/* ══════════════════════════════════════════════════════════════
   DICE RESULTS
   ══════════════════════════════════════════════════════════════ */

.dice-card {
  background: linear-gradient(135deg, #1a1a24 0%, #12121a 100%);
  border: 1px solid rgba(200,168,78,0.1);
  border-radius: 8px;
  padding: 10px 14px;
  position: relative; overflow: hidden;
  animation: unfurl 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.dice-card-crit {
  border-color: var(--color-gold) !important;
  box-shadow: 0 0 20px rgba(232,208,104,0.25);
}

.dice-card-fail {
  border-color: var(--color-blood-bright) !important;
  box-shadow: 0 0 16px rgba(204,34,34,0.25);
}

@keyframes unfurl {
  from { opacity: 0; transform: scaleY(0.8) translateY(-5px); }
  to { opacity: 1; transform: scaleY(1) translateY(0); }
}

.die-face {
  display: inline-flex; align-items: center; justify-content: center;
  min-width: 28px; height: 28px; padding: 2px 6px;
  border-radius: 4px;
  font-family: var(--font-cinzel); font-weight: 900; font-size: 13px;
  border: 1px solid var(--color-edge-bone);
  background: var(--color-obsidian); color: var(--color-bone);
}

.die-face-crit {
  background: linear-gradient(135deg, #3a2a10, #2a1e0a) !important;
  border-color: var(--color-gold) !important;
  color: var(--color-gold-bright) !important;
  box-shadow: 0 0 8px rgba(200,168,78,0.4);
}

.die-face-fail {
  background: linear-gradient(135deg, #2a0808, #1a0505) !important;
  border-color: var(--color-blood-bright) !important;
  color: var(--color-blood-bright) !important;
}

/* Total result */
.dice-total {
  font-family: var(--font-cinzel);
  font-size: 18px;
  font-weight: 900;
}

.dice-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 12px rgba(232,208,104,0.6);
}

.dice-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 8px rgba(204,34,34,0.5);
}

/* Вращающиеся лучи на крит-карте */
.crit-rays {
  position: absolute; inset: -50%;
  background: conic-gradient(
    from 0deg,
    transparent 0deg, rgba(232,208,104,0.06) 10deg, transparent 20deg,
    transparent 40deg, rgba(232,208,104,0.06) 50deg, transparent 60deg
  );
  animation: crit-spin 8s linear infinite;
  pointer-events: none;
}

@keyframes crit-spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* ══════════════════════════════════════════════════════════════
   COMBAT LOG
   ══════════════════════════════════════════════════════════════ */

.combat-log { font-family: var(--font-garamond); font-size: 12px; line-height: 1.6; }
.combat-log-line { padding: 2px 0; border-bottom: 1px solid rgba(42,37,32,0.2); }
.log-section { color: var(--color-gold-dark); font-family: var(--font-cinzel); font-size: 10px; text-transform: uppercase; letter-spacing: 0.1em; }
.log-crit { color: var(--color-gold-bright); font-weight: 700; }
.log-hit { color: #66cc66; }
.log-miss { color: var(--color-faded); font-style: italic; }
.log-mana { color: var(--color-mana-bright); }
.log-damage { color: var(--color-blood-bright); }
.log-info { color: var(--color-ancient); }

/* ══════════════════════════════════════════════════════════════
   LOADING SPINNER
   ══════════════════════════════════════════════════════════════ */

.rune-spinner {
  width: 48px; height: 48px;
  border: 2px solid rgba(200,168,78,0.15);
  border-top-color: var(--color-gold);
  border-radius: 50%;
  animation: rune-spin 1s linear infinite;
  position: relative;
  box-shadow: 0 0 15px rgba(200,168,78,0.2);
}

.rune-spinner::after {
  content: '⟐';
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: 16px; color: var(--color-gold);
  animation: rune-spin-reverse 2s linear infinite;
  text-shadow: 0 0 8px rgba(200,168,78,0.5);
}

@keyframes rune-spin { to { transform: rotate(360deg); } }
@keyframes rune-spin-reverse { to { transform: rotate(-360deg); } }

/* ══════════════════════════════════════════════════════════════
   INPUTS & FORMS
   ══════════════════════════════════════════════════════════════ */

input[type="text"],
input[type="number"],
input[type="url"],
textarea,
select {
  background: var(--color-abyss);
  border: 1px solid var(--color-edge-bone);
  border-radius: 6px;
  padding: 8px 10px;
  color: var(--color-bone);
  font-family: var(--font-garamond); font-size: 13px;
  transition: border-color 0.2s, box-shadow 0.2s;
  width: 100%;
}

input:focus, textarea:focus, select:focus {
  outline: none;
  border-color: var(--color-gold-dark);
  box-shadow: 0 0 10px rgba(200,168,78,0.2);
}

select {
  cursor: pointer; appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%238a7e66'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 28px;
}

input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button { opacity: 0.3; }

/* ══════════════════════════════════════════════════════════════
   UTILITY
   ══════════════════════════════════════════════════════════════ */

.animate-float { animation: float-gentle 3s ease-in-out infinite; }

@keyframes float-gentle {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
}

.animate-pulse-gold { animation: pulse-gold 2s ease-in-out infinite; }

@keyframes pulse-gold {
  0%, 100% { box-shadow: 0 0 0 rgba(200,168,78,0); }
  50% { box-shadow: 0 0 16px rgba(200,168,78,0.4); }
}

.animate-unfurl { animation: unfurl 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); }

.text-glow-gold { text-shadow: 0 0 10px rgba(200,168,78,0.5); }
.text-glow-blood { text-shadow: 0 0 10px rgba(204,34,34,0.5); }
.text-glow-mana { text-shadow: 0 0 10px rgba(68,153,221,0.5); }

.field-label {
  display: block;
  font-family: var(--font-cinzel); font-size: 9px; font-weight: 700;
  letter-spacing: 0.08em; text-transform: uppercase;
  color: var(--color-faded); margin-bottom: 4px;
}

.divider-rune {
  text-align: center; color: var(--color-gold-dark);
  font-size: 10px; letter-spacing: 8px;
  opacity: 0.4; padding: 4px 0;
}

.empty-state {
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  padding: 32px; text-align: center; min-height: 200px;
}

.empty-state-icon {
  font-size: 48px; margin-bottom: 12px;
  opacity: 0.5; animation: float-gentle 3s ease-in-out infinite;

}
/* ══════════════════════════════════════════════════════════════
   COMPACT MODE — Мини-виджет
   ══════════════════════════════════════════════════════════════ */

.compact-frame {
  background: linear-gradient(180deg, #0e0e16 0%, #0a0a0f 100%);
  border: 1px solid rgba(200,168,78,0.2);
  border-radius: 10px;
  padding: 0;
  overflow: hidden;
  box-shadow: 0 4px 20px rgba(0,0,0,0.5), inset 0 1px 0 rgba(200,168,78,0.05);
  margin: 4px;
}

.compact-frame-danger {
  border-color: rgba(204,34,34,0.4);
  box-shadow: 0 4px 20px rgba(0,0,0,0.5), 0 0 12px rgba(204,34,34,0.15);
}

.compact-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 10px;
  background: rgba(200,168,78,0.04);
  border-bottom: 1px solid rgba(200,168,78,0.1);
}

.compact-expand-btn {
  width: 22px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(200,168,78,0.2);
  border-radius: 4px;
  background: rgba(200,168,78,0.05);
  color: var(--color-gold);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  flex-shrink: 0;
}

.compact-expand-btn:hover {
  background: rgba(200,168,78,0.15);
  box-shadow: 0 0 8px rgba(200,168,78,0.3);
  color: var(--color-gold-bright);
}

/* Мини бары */
.compact-bar {
  position: relative;
  height: 18px;
  margin: 4px 8px;
  border-radius: 9px;
  overflow: hidden;
}

.compact-bar-bg {
  position: absolute;
  inset: 0;
  border-radius: 9px;
}

.compact-bar-hp-bg {
  background: linear-gradient(180deg, #1a0808, #2a0e0e);
  border: 1px solid #3a1212;
}

.compact-bar-mana-bg {
  background: linear-gradient(180deg, #0a1520, #0e1a28);
  border: 1px solid #1a3050;
}

.compact-bar-fill {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  border-radius: 9px;
  transition: width 0.4s ease;
}

.compact-bar-hp-fill {
  background: linear-gradient(180deg, #cc2222, #881414);
}

.compact-bar-mana-fill {
  background: linear-gradient(180deg, #4499dd, #2a5a8a);
}

.compact-bar-text {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-cinzel);
  font-size: 9px;
  font-weight: 700;
  color: #fff;
  text-shadow: 0 1px 3px rgba(0,0,0,0.8);
  z-index: 2;
  letter-spacing: 0.5px;
}

/* Быстрые кнопки */
.compact-actions {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 3px;
  padding: 5px 8px 6px;
}

.compact-btn {
  width: 28px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  font-family: var(--font-cinzel);
  font-size: 9px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.15s;
  border: 1px solid transparent;
}

.compact-btn:active {
  transform: scale(0.9);
}

.compact-btn-damage {
  background: linear-gradient(180deg, #2a0a0a, #1a0505);
  border-color: #3a1212;
  color: var(--color-blood-bright);
}

.compact-btn-damage:hover {
  border-color: var(--color-blood-bright);
  box-shadow: 0 0 6px rgba(204,34,34,0.3);
}

.compact-btn-heal {
  background: linear-gradient(180deg, #0a2a0a, #051a05);
  border-color: #1a3a1a;
  color: #44cc44;
}

.compact-btn-heal:hover {
  border-color: #44cc44;
  box-shadow: 0 0 6px rgba(68,204,68,0.3);
}

.compact-divider {
  width: 1px;
  height: 16px;
  background: rgba(200,168,78,0.15);
  margin: 0 2px;
}

/* Кнопка свернуть (в полном режиме) */
.compact-toggle-btn {
  position: absolute;
  top: 6px;
  right: 6px;
  z-index: 50;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(200,168,78,0.15);
  border-radius: 4px;
  background: rgba(10,10,15,0.8);
  color: var(--color-gold-dark);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  backdrop-filter: blur(4px);
}

.compact-toggle-btn:hover {
  background: rgba(200,168,78,0.1);
  color: var(--color-gold);
  box-shadow: 0 0 8px rgba(200,168,78,0.2);
   /* ══════════════════════════════════════════════════════════════
   ROK CARDS — 3D карты с переворотом
   ══════════════════════════════════════════════════════════════ */

/* Счётчик колоды */
.deck-counter {
  text-align: center;
  padding: 16px 12px;
  background: linear-gradient(180deg, rgba(200,168,78,0.04) 0%, transparent 100%);
  border: 1px solid rgba(200,168,78,0.1);
  border-radius: 8px;
}

.deck-counter-name {
  font-family: var(--font-cinzel);
  font-size: 11px;
  color: var(--color-faded);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 8px;
}

.deck-counter-number {
  font-family: var(--font-cinzel-decorative);
  font-size: 48px;
  font-weight: 900;
  color: var(--color-gold-bright);
  text-shadow: 0 0 20px rgba(200,168,78,0.4), 0 2px 4px rgba(0,0,0,0.5);
  line-height: 1;
  transition: color 0.3s, text-shadow 0.3s;
}

.deck-counter-number.low {
  color: #ccaa22;
  text-shadow: 0 0 15px rgba(204,170,34,0.4);
  animation: pulse-gold 2s ease-in-out infinite;
}

.deck-counter-number.empty {
  color: var(--color-blood-bright);
  text-shadow: 0 0 15px rgba(204,34,34,0.4);
}

.deck-counter-label {
  font-family: var(--font-garamond);
  font-size: 12px;
  color: var(--color-dim);
  margin-top: 4px;
}

/* 3D контейнер для карты */
.card-3d {
  perspective: 800px;
  position: relative;
}

.card-3d-inner {
  position: relative;
  width: 100%;
  min-height: 120px;
  transform-style: preserve-3d;
  transition: transform 0.6s;
}

/* Анимация переворота */
.animate-card-flip {
  animation: card-flip-anim 0.8s ease-out forwards;
}

@keyframes card-flip-anim {
  0% { transform: rotateY(0deg) scale(0.9); }
  50% { transform: rotateY(90deg) scale(1.05); }
  100% { transform: rotateY(180deg) scale(1); }
}

/* Рубашка карты */
.card-front {
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  background: linear-gradient(135deg, #1a1428 0%, #0e0a1a 100%);
  border: 2px solid var(--color-gold-dark);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 16px rgba(0,0,0,0.4);
  /* Узор на рубашке */
  background-image:
    repeating-linear-gradient(45deg, transparent, transparent 8px, rgba(200,168,78,0.03) 8px, rgba(200,168,78,0.03) 9px),
    repeating-linear-gradient(-45deg, transparent, transparent 8px, rgba(200,168,78,0.03) 8px, rgba(200,168,78,0.03) 9px);
}

.card-front-symbol {
  font-size: 40px;
  filter: drop-shadow(0 0 8px rgba(200,168,78,0.3));
  animation: float-gentle 2s ease-in-out infinite;
}

/* Лицевая сторона */
.card-back {
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  transform: rotateY(180deg);
  border-radius: 8px;
  overflow: hidden;
}

/* Попадание / промах */
.rok-card-hit {
  background: linear-gradient(135deg, #141e14 0%, #0e160e 100%);
  border: 1px solid rgba(68,204,68,0.2);
  box-shadow: 0 0 12px rgba(68,204,68,0.1), inset 0 1px 0 rgba(68,204,68,0.05);
}

.rok-card-miss {
  background: linear-gradient(135deg, #1e1414 0%, #160e0e 100%);
  border: 1px solid rgba(204,34,34,0.15);
  box-shadow: 0 0 8px rgba(204,34,34,0.08);
  opacity: 0.85;
}

/* Заголовок карты */
.rok-card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 8px;
  padding-bottom: 6px;
  border-bottom: 1px solid rgba(200,168,78,0.1);
}

.rok-card-number {
  font-family: var(--font-cinzel);
  font-size: 11px;
  font-weight: 700;
  color: var(--color-gold);
  text-shadow: 0 0 6px rgba(200,168,78,0.3);
}

.rok-card-status {
  font-family: var(--font-cinzel);
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.05em;
}

.rok-card-status-hit {
  color: #66cc66;
  text-shadow: 0 0 6px rgba(68,204,68,0.4);
}

.rok-card-status-miss {
  color: var(--color-blood-bright);
  text-shadow: 0 0 6px rgba(204,34,34,0.3);
}

/* Название эффекта */
.rok-card-effect {
  font-family: var(--font-cinzel);
  font-size: 12px;
  font-weight: 700;
  color: var(--color-gold-bright);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-bottom: 4px;
  text-shadow: 0 0 8px rgba(200,168,78,0.3);
}

/* Описание */
.rok-card-desc {
  font-family: var(--font-garamond);
  font-size: 11px;
  color: var(--color-bone);
  line-height: 1.4;
  margin-bottom: 8px;
  opacity: 0.85;
}

/* Дополнительные броски */
.rok-card-rolls {
  background: rgba(0,0,0,0.25);
  border: 1px solid rgba(200,168,78,0.08);
  border-radius: 4px;
  padding: 6px 8px;
  margin-bottom: 8px;
}

.rok-card-roll-item {
  font-family: var(--font-garamond);
  font-size: 11px;
  color: var(--color-ancient);
  padding: 2px 0;
}

.rok-card-roll-item:not(:last-child) {
  border-bottom: 1px solid rgba(200,168,78,0.05);
}

/* Бейджи (рикошет, доп карты) */
.rok-card-badge {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 10px;
  font-family: var(--font-cinzel);
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.05em;
  text-transform: uppercase;
}

.rok-card-badge-recursive {
  background: rgba(68,153,221,0.15);
  border: 1px solid rgba(68,153,221,0.3);
  color: var(--color-mana-bright);
  animation: pulse-mana 2s ease-in-out infinite;
}

@keyframes pulse-mana {
  0%, 100% { box-shadow: 0 0 0 rgba(68,153,221,0); }
  50% { box-shadow: 0 0 10px rgba(68,153,221,0.3); }
}

.rok-card-badge-extra {
  background: rgba(200,168,78,0.15);
  border: 1px solid rgba(200,168,78,0.3);
  color: var(--color-gold-bright);
  animation: pulse-gold 2s ease-in-out infinite;
}

/* ══════════════════════════════════════════════════════════════
   ROK CARD — Эффекты по номерам (цветовые акценты)
   ══════════════════════════════════════════════════════════════ */

/* Стихийный хаос (1) — радужная рамка */
.rok-effect-1 { border-color: rgba(255,100,50,0.3) !important; }

/* Барьер (2) — голубой щит */
.rok-effect-2 { border-color: rgba(100,180,255,0.3) !important; }

/* Исцеление (4) — зелёное свечение */
.rok-effect-4 {
  border-color: rgba(68,204,68,0.3) !important;
  box-shadow: 0 0 12px rgba(68,204,68,0.15) !important;
}

/* Нежить (5) — фиолетовый */
.rok-effect-5 { border-color: rgba(150,50,200,0.3) !important; }

/* Чистый урон (6) — белый */
.rok-effect-6 { border-color: rgba(255,255,255,0.2) !important; }

/* Перевёрнутый мир (7) — инверсия */
.rok-effect-7 {
  border-color: rgba(255,200,50,0.3) !important;
  filter: hue-rotate(180deg);
  animation: world-flip 0.5s ease-out;
}

@keyframes world-flip {
  0% { filter: hue-rotate(0deg); }
  100% { filter: hue-rotate(180deg); }
}

/* Клон (8) — мерцание */
.rok-effect-8 {
  animation: clone-flicker 0.3s ease-out 2;
}

@keyframes clone-flicker {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* Ярость (16) — красное свечение */
.rok-effect-16 {
  border-color: rgba(255,50,50,0.4) !important;
  box-shadow: 0 0 20px rgba(255,50,50,0.2) !important;
}

/* Раздвоение (17) — золотое сияние */
.rok-effect-17 {
  border-color: var(--color-gold) !important;
  box-shadow: 0 0 25px rgba(200,168,78,0.3) !important;
}

/* Портал (18) — пурпурный вихрь */
.rok-effect-18 {
  border-color: rgba(150,50,200,0.4) !important;
  box-shadow: 0 0 20px rgba(150,50,200,0.2) !important;
  position: relative;
  overflow: hidden;
}

/* Обмен HP (20) — пульсация */
.rok-effect-20 {
  animation: hp-swap-pulse 1s ease-in-out 2;
}

@keyframes hp-swap-pulse {
  0%, 100% { box-shadow: 0 0 0 rgba(204,34,34,0); }
  50% { box-shadow: 0 0 20px rgba(204,34,34,0.3), 0 0 20px rgba(68,204,68,0.3); }
}
  border-color: rgba(200,168,78,0.3);
}
/* ══════════════════════════════════════════════════════════════
   MODE SWITCHER — Переключатель режимов
   ══════════════════════════════════════════════════════════════ */

.mode-switcher {
  position: absolute;
  top: 6px;
  right: 6px;
  z-index: 50;
  display: flex;
  gap: 3px;
}

.compact-mode-btn {
  width: 22px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(200,168,78,0.15);
  border-radius: 4px;
  background: rgba(10,10,15,0.8);
  color: var(--color-gold-dark);
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s;
  backdrop-filter: blur(4px);
}

.compact-mode-btn:hover {
  background: rgba(200,168,78,0.1);
  color: var(--color-gold);
  box-shadow: 0 0 8px rgba(200,168,78,0.2);
  border-color: rgba(200,168,78,0.3);
}

.compact-mode-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

/* Кнопка навигации юнитов (compact) */
.compact-nav-btn {
  width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  background: transparent;
  color: var(--color-gold-dark);
  cursor: pointer;
  font-size: 12px;
  transition: color 0.15s;
  flex-shrink: 0;
}

.compact-nav-btn:hover:not(:disabled) {
  color: var(--color-gold);
}

.compact-nav-btn:disabled {
  opacity: 0.2;
  cursor: default;
}

/* ══════════════════════════════════════════════════════════════
   LARGE MODE — Полноэкранный гримуар
   ══════════════════════════════════════════════════════════════ */

.large-frame {
  height: 100%;
  display: flex;
  flex-direction: column;
  background:
    repeating-linear-gradient(0deg, transparent, rgba(200,168,78,0.006) 1px, transparent 2px),
    repeating-linear-gradient(90deg, transparent, rgba(200,168,78,0.004) 1px, transparent 3px),
    radial-gradient(ellipse at 20% 0%, rgba(200,168,78,0.05) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 100%, rgba(42,90,138,0.03) 0%, transparent 50%),
    linear-gradient(180deg, #0e0e16 0%, #0a0a0f 40%, #080810 100%);
  border: 1px solid rgba(200,168,78,0.12);
}

/* Шапка */
.large-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 16px;
  background: linear-gradient(180deg, rgba(200,168,78,0.04) 0%, transparent 100%);
  border-bottom: 1px solid rgba(200,168,78,0.1);
  flex-shrink: 0;
}

/* Тело: 2 колонки */
.large-body {
  flex: 1;
  display: flex;
  overflow: hidden;
  min-height: 0;
}

/* Левая колонка — сайдбар */
.large-sidebar {
  width: 280px;
  min-width: 280px;
  display: flex;
  flex-direction: column;
  border-right: 1px solid rgba(200,168,78,0.08);
  overflow-y: auto;
  background: rgba(0,0,0,0.15);
}

/* Лог в сайдбаре */
.large-log {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
  border-top: 1px solid rgba(200,168,78,0.08);
}

.large-log-header {
  padding: 8px 12px;
  border-bottom: 1px solid rgba(200,168,78,0.06);
  flex-shrink: 0;
}

.large-log-body {
  flex: 1;
  overflow-y: auto;
  padding: 4px 8px;
}

.large-log-entry {
  padding: 3px 4px;
  border-bottom: 1px solid rgba(42,37,32,0.15);
  font-family: var(--font-garamond);
  font-size: 11px;
  line-height: 1.4;
}

/* Правая колонка — основной контент */
.large-main {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0;
  overflow: hidden;
}

/* Вкладки в large mode — горизонтальные с текстом */
.large-tabs {
  display: flex;
  border-bottom: 1px solid rgba(200,168,78,0.1);
  flex-shrink: 0;
  background: rgba(200,168,78,0.02);
}

.large-tab {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  padding: 8px 4px;
  cursor: pointer;
  transition: all 0.2s;
  border: none;
  background: transparent;
  position: relative;
}

.large-tab-active {
  color: var(--color-gold-bright);
  background: linear-gradient(180deg, rgba(200,168,78,0.08) 0%, transparent 100%);
  text-shadow: 0 0 8px rgba(200,168,78,0.4);
}

.large-tab-active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 15%;
  right: 15%;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--color-gold), transparent);
}

.large-tab-inactive {
  color: var(--color-faded);
  opacity: 0.6;
}

.large-tab-inactive:hover {
  opacity: 1;
  color: var(--color-bone);
  background: rgba(255,255,255,0.02);
}

.large-tab-content {
  flex: 1;
  overflow: hidden;
  min-height: 0;
}

/* ══════════════════════════════════════════════════════════════
   RESPONSIVE — Адаптация под разные размеры
   ══════════════════════════════════════════════════════════════ */

/* Если окно узкое — скрыть текст в large tabs */
@media (max-width: 500px) {
  .large-body {
    flex-direction: column;
  }

  .large-sidebar {
    width: 100%;
    min-width: 100%;
    max-height: 200px;
    border-right: none;
    border-bottom: 1px solid rgba(200,168,78,0.08);
  }

  .large-log {
    display: none;
  }

  .large-tab span:last-child {
    display: none;
  }
}

/* Средние размеры */
@media (min-width: 501px) and (max-width: 700px) {
  .large-sidebar {
    width: 220px;
    min-width: 220px;
  }
}
/* ══════════════════════════════════════════════════════════════
   BROADCAST OVERLAY — Кастомные уведомления для ВСЕХ
   ══════════════════════════════════════════════════════════════ */

.bc-overlay {
  position: fixed;
  top: 8px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 300;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  pointer-events: none;
  max-width: 380px;
  width: 95%;
}

/* ── Карточка уведомления ──────────────────────────────── */

.bc-card {
  width: 100%;
  border-radius: 10px;
  padding: 12px 16px;
  position: relative;
  overflow: hidden;
  pointer-events: auto;
  backdrop-filter: blur(12px);
  transition: opacity 0.5s, transform 0.5s;
}

/* Фазы анимации */
.bc-enter {
  opacity: 0;
  transform: translateY(-30px) scale(0.9);
}

.bc-visible {
  opacity: 1;
  transform: translateY(0) scale(1);
  transition: opacity 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
              transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.bc-exit {
  opacity: 0;
  transform: translateY(-20px) scale(0.95);
  transition: opacity 0.5s ease-out, transform 0.5s ease-out;
}

/* ── Цветовые схемы ────────────────────────────────────── */

.bc-gold {
  background: linear-gradient(135deg, rgba(42,30,10,0.95) 0%, rgba(20,14,6,0.95) 100%);
  border: 1px solid rgba(200,168,78,0.4);
  box-shadow: 0 4px 24px rgba(0,0,0,0.5), 0 0 20px rgba(200,168,78,0.1);
}

.bc-blood {
  background: linear-gradient(135deg, rgba(42,10,10,0.95) 0%, rgba(26,5,5,0.95) 100%);
  border: 1px solid rgba(204,34,34,0.4);
  box-shadow: 0 4px 24px rgba(0,0,0,0.5), 0 0 15px rgba(204,34,34,0.1);
}

.bc-mana {
  background: linear-gradient(135deg, rgba(14,26,42,0.95) 0%, rgba(10,20,30,0.95) 100%);
  border: 1px solid rgba(68,153,221,0.4);
  box-shadow: 0 4px 24px rgba(0,0,0,0.5), 0 0 15px rgba(68,153,221,0.1);
}

.bc-green {
  background: linear-gradient(135deg, rgba(10,42,10,0.95) 0%, rgba(5,26,5,0.95) 100%);
  border: 1px solid rgba(68,204,68,0.4);
  box-shadow: 0 4px 24px rgba(0,0,0,0.5), 0 0 15px rgba(68,204,68,0.1);
}

.bc-purple {
  background: linear-gradient(135deg, rgba(30,10,42,0.95) 0%, rgba(18,6,26,0.95) 100%);
  border: 1px solid rgba(150,80,220,0.4);
  box-shadow: 0 4px 24px rgba(0,0,0,0.5), 0 0 15px rgba(150,80,220,0.1);
}

.bc-white {
  background: linear-gradient(135deg, rgba(26,26,34,0.95) 0%, rgba(18,18,24,0.95) 100%);
  border: 1px solid rgba(200,190,170,0.2);
  box-shadow: 0 4px 24px rgba(0,0,0,0.5);
}

/* ── Крит усиление ─────────────────────────────────────── */

.bc-crit {
  border-color: var(--color-gold) !important;
  box-shadow: 0 4px 24px rgba(0,0,0,0.5), 0 0 30px rgba(232,208,104,0.25) !important;
  animation: bc-crit-glow 1.5s ease-in-out;
}

@keyframes bc-crit-glow {
  0% { box-shadow: 0 0 60px rgba(232,208,104,0.5); }
  50% { box-shadow: 0 0 40px rgba(232,208,104,0.3); }
  100% { box-shadow: 0 4px 24px rgba(0,0,0,0.5), 0 0 30px rgba(232,208,104,0.25); }
}

.bc-fail {
  border-color: var(--color-blood-bright) !important;
  box-shadow: 0 4px 24px rgba(0,0,0,0.5), 0 0 20px rgba(204,34,34,0.2) !important;
}

/* ── Крит-лучи ─────────────────────────────────────────── */

.bc-crit-rays {
  position: absolute;
  inset: -100%;
  background: conic-gradient(
    from 0deg,
    transparent 0deg, rgba(232,208,104,0.08) 8deg, transparent 16deg,
    transparent 30deg, rgba(232,208,104,0.08) 38deg, transparent 46deg,
    transparent 60deg, rgba(232,208,104,0.06) 68deg, transparent 76deg
  );
  animation: crit-spin 6s linear infinite;
  pointer-events: none;
}

/* Трещина при фейле */
.bc-fail-crack {
  position: absolute;
  inset: 0;
  background:
    linear-gradient(135deg, transparent 45%, rgba(204,34,34,0.15) 48%, transparent 52%),
    linear-gradient(225deg, transparent 45%, rgba(204,34,34,0.1) 49%, transparent 53%);
  pointer-events: none;
}

/* ── Декоративные уголки ───────────────────────────────── */

.bc-corner {
  position: absolute;
  width: 8px;
  height: 8px;
  opacity: 0.4;
}

.bc-corner::before, .bc-corner::after {
  content: '';
  position: absolute;
  background: currentColor;
}

.bc-corner-tl { top: 4px; left: 4px; color: var(--color-gold-dark); }
.bc-corner-tl::before { top: 0; left: 0; width: 8px; height: 1px; }
.bc-corner-tl::after { top: 0; left: 0; width: 1px; height: 8px; }

.bc-corner-tr { top: 4px; right: 4px; color: var(--color-gold-dark); }
.bc-corner-tr::before { top: 0; right: 0; width: 8px; height: 1px; }
.bc-corner-tr::after { top: 0; right: 0; width: 1px; height: 8px; }

.bc-corner-bl { bottom: 4px; left: 4px; color: var(--color-gold-dark); }
.bc-corner-bl::before { bottom: 0; left: 0; width: 8px; height: 1px; }
.bc-corner-bl::after { bottom: 0; left: 0; width: 1px; height: 8px; }

.bc-corner-br { bottom: 4px; right: 4px; color: var(--color-gold-dark); }
.bc-corner-br::before { bottom: 0; right: 0; width: 8px; height: 1px; }
.bc-corner-br::after { bottom: 0; right: 0; width: 1px; height: 8px; }

/* ── Тело уведомления ──────────────────────────────────── */

.bc-body {
  display: flex;
  gap: 12px;
  align-items: flex-start;
  position: relative;
  z-index: 2;
}

.bc-icon {
  font-size: 28px;
  flex-shrink: 0;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));
  line-height: 1;
}

.bc-icon-crit {
  animation: bc-icon-pulse 0.6s ease-out;
  font-size: 34px;
}

@keyframes bc-icon-pulse {
  0% { transform: scale(0.5) rotate(-15deg); }
  50% { transform: scale(1.3) rotate(5deg); }
  100% { transform: scale(1) rotate(0deg); }
}

.bc-text {
  flex: 1;
  min-width: 0;
}

.bc-unit-name {
  font-family: var(--font-cinzel);
  font-size: 9px;
  font-weight: 700;
  color: var(--color-faded);
  text-transform: uppercase;
  letter-spacing: 0.12em;
  margin-bottom: 2px;
}

.bc-title {
  font-family: var(--font-cinzel);
  font-size: 14px;
  font-weight: 700;
  color: var(--color-bone);
  line-height: 1.2;
  margin-bottom: 4px;
}

.bc-title-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 12px rgba(232,208,104,0.5);
  font-size: 16px;
}

.bc-title-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 8px rgba(204,34,34,0.4);
}

/* ── Кубики ────────────────────────────────────────────── */

.bc-rolls {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  align-items: center;
  margin-bottom: 4px;
}

.bc-die {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 24px;
  height: 24px;
  padding: 0 4px;
  border-radius: 4px;
  font-family: var(--font-cinzel);
  font-weight: 900;
  font-size: 12px;
  background: rgba(0,0,0,0.3);
  border: 1px solid rgba(200,190,170,0.15);
  color: var(--color-bone);
}

.bc-die-crit {
  background: rgba(200,168,78,0.2) !important;
  border-color: var(--color-gold) !important;
  color: var(--color-gold-bright) !important;
  box-shadow: 0 0 6px rgba(200,168,78,0.3);
  animation: bc-die-pop 0.4s ease-out;
}

.bc-die-fail {
  background: rgba(204,34,34,0.2) !important;
  border-color: var(--color-blood-bright) !important;
  color: var(--color-blood-bright) !important;
}

@keyframes bc-die-pop {
  0% { transform: scale(0.5) rotate(-20deg); }
  60% { transform: scale(1.2) rotate(5deg); }
  100% { transform: scale(1) rotate(0deg); }
}

.bc-total {
  font-family: var(--font-cinzel);
  font-size: 16px;
  font-weight: 900;
  color: var(--color-bone);
  margin-left: 4px;
  text-shadow: 0 1px 3px rgba(0,0,0,0.5);
}

.bc-subtitle {
  font-family: var(--font-garamond);
  font-size: 11px;
  color: var(--color-ancient);
  font-style: italic;
  margin-bottom: 2px;
}

/* ── Детали ────────────────────────────────────────────── */

.bc-details {
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  padding: 4px 8px;
  margin-top: 4px;
}

.bc-detail-line {
  font-family: var(--font-garamond);
  font-size: 11px;
  color: var(--color-faded);
  padding: 1px 0;
  line-height: 1.4;
}

/* ── HP бар в уведомлении ──────────────────────────────── */

.bc-hp-bar {
  position: relative;
  height: 14px;
  border-radius: 7px;
  overflow: hidden;
  margin-top: 6px;
  background: rgba(0,0,0,0.3);
  border: 1px solid rgba(255,255,255,0.08);
}

.bc-hp-fill {
  position: absolute;
  left: 0; top: 0; bottom: 0;
  border-radius: 7px;
  transition: width 0.6s ease;
}

.bc-hp-damage {
  background: linear-gradient(90deg, #cc2222, #881414);
}

.bc-hp-heal {
  background: linear-gradient(90deg, #22cc44, #118822);
}

.bc-hp-text {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-cinzel);
  font-size: 9px;
  font-weight: 700;
  color: #fff;
  text-shadow: 0 1px 3px rgba(0,0,0,0.8);
  z-index: 2;
}

/* ── Баннер крит/провал ────────────────────────────────── */

.bc-banner {
  text-align: center;
  font-family: var(--font-cinzel);
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  padding: 4px 0 0;
  margin-top: 6px;
  border-top: 1px solid rgba(255,255,255,0.06);
  position: relative;
  z-index: 2;
}

.bc-banner-crit {
  color: var(--color-gold-bright);
  text-shadow: 0 0 12px rgba(232,208,104,0.5);
  animation: bc-banner-flash 0.8s ease-out;
}

.bc-banner-fail {
  color: var(--color-blood-bright);
  text-shadow: 0 0 8px rgba(204,34,34,0.5);
}

@keyframes bc-banner-flash {
  0% { opacity: 0; letter-spacing: 0.3em; }
  50% { opacity: 1; letter-spacing: 0.2em; }
  100% { opacity: 1; letter-spacing: 0.15em; }
}

/* ══════════════════════════════════════════════════════════════
   DICE TOAST — Компактные уведомления в правом нижнем углу
   ══════════════════════════════════════════════════════════════ */

.dice-toast-container {
  position: fixed;
  bottom: 12px;
  right: 12px;
  z-index: 1000;
  display: flex;
  flex-direction: column-reverse;
  gap: 8px;
  pointer-events: none;
  max-width: 320px;
  width: calc(100% - 24px);
}

/* ── Базовый toast ────────────────────────────────────────── */

.dice-toast {
  position: relative;
  border-radius: 12px;
  padding: 10px 14px;
  pointer-events: auto;
  cursor: pointer;
  overflow: hidden;
  backdrop-filter: blur(16px);
  transform-origin: bottom right;
  
  /* Тень и свечение */
  box-shadow: 
    0 4px 20px rgba(0,0,0,0.4),
    0 0 1px rgba(255,255,255,0.1),
    inset 0 1px 0 rgba(255,255,255,0.05);
}

.dice-toast:hover {
  transform: scale(1.02) !important;
  box-shadow: 
    0 6px 25px rgba(0,0,0,0.5),
    0 0 1px rgba(255,255,255,0.15);
}

.dice-toast:active {
  transform: scale(0.98) !important;
}

/* ── Фоновое свечение ─────────────────────────────────────── */

.toast-glow {
  position: absolute;
  inset: -50%;
  opacity: 0.15;
  pointer-events: none;
  transition: opacity 0.3s;
}

.dice-toast:hover .toast-glow {
  opacity: 0.25;
}

/* ── Цветовые схемы ───────────────────────────────────────── */

.toast-color-gold {
  background: linear-gradient(135deg, rgba(32,26,12,0.95) 0%, rgba(20,16,8,0.98) 100%);
  border: 1px solid rgba(200,168,78,0.35);
}
.toast-color-gold .toast-glow {
  background: radial-gradient(ellipse at center, rgba(200,168,78,0.4) 0%, transparent 70%);
}

.toast-color-blood {
  background: linear-gradient(135deg, rgba(32,12,12,0.95) 0%, rgba(20,8,8,0.98) 100%);
  border: 1px solid rgba(204,34,34,0.35);
}
.toast-color-blood .toast-glow {
  background: radial-gradient(ellipse at center, rgba(204,34,34,0.4) 0%, transparent 70%);
}

.toast-color-mana {
  background: linear-gradient(135deg, rgba(12,20,32,0.95) 0%, rgba(8,14,24,0.98) 100%);
  border: 1px solid rgba(68,153,221,0.35);
}
.toast-color-mana .toast-glow {
  background: radial-gradient(ellipse at center, rgba(68,153,221,0.4) 0%, transparent 70%);
}

.toast-color-green {
  background: linear-gradient(135deg, rgba(12,32,12,0.95) 0%, rgba(8,20,8,0.98) 100%);
  border: 1px solid rgba(68,204,68,0.35);
}
.toast-color-green .toast-glow {
  background: radial-gradient(ellipse at center, rgba(68,204,68,0.4) 0%, transparent 70%);
}

.toast-color-purple {
  background: linear-gradient(135deg, rgba(24,12,32,0.95) 0%, rgba(16,8,20,0.98) 100%);
  border: 1px solid rgba(150,80,220,0.35);
}
.toast-color-purple .toast-glow {
  background: radial-gradient(ellipse at center, rgba(150,80,220,0.4) 0%, transparent 70%);
}

.toast-color-white {
  background: linear-gradient(135deg, rgba(24,24,28,0.95) 0%, rgba(16,16,20,0.98) 100%);
  border: 1px solid rgba(200,190,170,0.2);
}
.toast-color-white .toast-glow {
  background: radial-gradient(ellipse at center, rgba(200,190,170,0.2) 0%, transparent 70%);
}

/* ── Анимации появления/исчезновения ──────────────────────── */

.toast-enter {
  opacity: 0;
  transform: translateX(100%) scale(0.8) rotateZ(5deg);
}

.toast-visible {
  opacity: 1;
  transform: translateX(0) scale(1) rotateZ(0deg);
  transition: 
    opacity 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
    transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.toast-exit {
  opacity: 0;
  transform: translateX(50%) scale(0.9) rotateZ(-3deg);
  transition: 
    opacity 0.4s ease-out,
    transform 0.4s ease-out;
}

/* ── Крит-эффекты ─────────────────────────────────────────── */

.toast-crit {
  border-color: var(--color-gold) !important;
  box-shadow: 
    0 4px 20px rgba(0,0,0,0.4),
    0 0 30px rgba(232,208,104,0.25),
    0 0 60px rgba(232,208,104,0.1),
    inset 0 0 20px rgba(232,208,104,0.05) !important;
  animation: toast-crit-entrance 0.6s ease-out;
}

@keyframes toast-crit-entrance {
  0% {
    transform: translateX(100%) scale(0.5) rotateZ(15deg);
    filter: brightness(2);
  }
  50% {
    transform: translateX(-10px) scale(1.1) rotateZ(-3deg);
    filter: brightness(1.5);
  }
  70% {
    transform: translateX(5px) scale(1.05);
  }
  100% {
    transform: translateX(0) scale(1) rotateZ(0);
    filter: brightness(1);
  }
}

/* Вращающиеся лучи на крите */
.toast-crit-rays {
  position: absolute;
  inset: -200%;
  background: conic-gradient(
    from 0deg,
    transparent 0deg, rgba(232,208,104,0.08) 5deg, transparent 10deg,
    transparent 20deg, rgba(232,208,104,0.06) 25deg, transparent 30deg,
    transparent 40deg, rgba(232,208,104,0.08) 45deg, transparent 50deg,
    transparent 60deg, rgba(232,208,104,0.05) 65deg, transparent 70deg,
    transparent 80deg, rgba(232,208,104,0.07) 85deg, transparent 90deg
  );
  animation: toast-rays-spin 8s linear infinite;
  pointer-events: none;
}

@keyframes toast-rays-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ── Провал-эффекты ───────────────────────────────────────── */

.toast-fail {
  border-color: var(--color-blood-bright) !important;
  box-shadow: 
    0 4px 20px rgba(0,0,0,0.4),
    0 0 20px rgba(204,34,34,0.2) !important;
  animation: toast-fail-entrance 0.5s ease-out;
}

@keyframes toast-fail-entrance {
  0% {
    transform: translateX(100%) scale(0.8);
  }
  20% {
    transform: translateX(-5px) scale(1.02);
  }
  40% {
    transform: translateX(3px);
  }
  60% {
    transform: translateX(-2px);
  }
  80% {
    transform: translateX(1px);
  }
  100% {
    transform: translateX(0) scale(1);
  }
}

/* Трещины на провале */
.toast-fail-cracks {
  position: absolute;
  inset: 0;
  background:
    linear-gradient(120deg, transparent 40%, rgba(204,34,34,0.15) 45%, transparent 50%),
    linear-gradient(240deg, transparent 42%, rgba(204,34,34,0.1) 47%, transparent 52%),
    linear-gradient(60deg, transparent 44%, rgba(204,34,34,0.08) 48%, transparent 52%);
  pointer-events: none;
  animation: toast-cracks-appear 0.3s ease-out 0.2s both;
}

@keyframes toast-cracks-appear {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ── Контент ──────────────────────────────────────────────── */

.toast-content {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  position: relative;
  z-index: 2;
}

/* Иконка */
.toast-icon {
  font-size: 24px;
  flex-shrink: 0;
  line-height: 1;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.4));
  animation: toast-icon-pop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s both;
}

@keyframes toast-icon-pop {
  0% {
    transform: scale(0) rotate(-45deg);
    opacity: 0;
  }
  100% {
    transform: scale(1) rotate(0);
    opacity: 1;
  }
}

.toast-icon-crit {
  font-size: 28px;
  animation: toast-icon-crit-pop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) both;
  filter: drop-shadow(0 0 8px rgba(232,208,104,0.6));
}

@keyframes toast-icon-crit-pop {
  0% {
    transform: scale(0) rotate(-180deg);
    opacity: 0;
  }
  50% {
    transform: scale(1.3) rotate(15deg);
  }
  100% {
    transform: scale(1) rotate(0);
    opacity: 1;
  }
}

.toast-icon-fail {
  animation: toast-icon-fail-shake 0.5s ease-out both;
}

@keyframes toast-icon-fail-shake {
  0%, 100% { transform: translateX(0); }
  20% { transform: translateX(-4px) rotate(-5deg); }
  40% { transform: translateX(4px) rotate(5deg); }
  60% { transform: translateX(-3px) rotate(-3deg); }
  80% { transform: translateX(2px) rotate(2deg); }
}

/* Тело текста */
.toast-body {
  flex: 1;
  min-width: 0;
}

.toast-unit {
  font-family: var(--font-cinzel);
  font-size: 9px;
  font-weight: 700;
  color: var(--color-faded);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 1px;
  opacity: 0;
  animation: toast-text-slide 0.3s ease-out 0.15s forwards;
}

.toast-title {
  font-family: var(--font-cinzel);
  font-size: 13px;
  font-weight: 700;
  color: var(--color-bone);
  line-height: 1.2;
  opacity: 0;
  animation: toast-text-slide 0.3s ease-out 0.2s forwards;
}

.toast-title-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 10px rgba(232,208,104,0.5);
  font-size: 14px;
}

.toast-title-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 8px rgba(204,34,34,0.4);
}

.toast-subtitle {
  font-family: var(--font-garamond);
  font-size: 11px;
  color: var(--color-ancient);
  font-style: italic;
  margin-top: 2px;
  opacity: 0;
  animation: toast-text-slide 0.3s ease-out 0.25s forwards;
}

@keyframes toast-text-slide {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* ── Кубики ───────────────────────────────────────────────── */

.toast-rolls {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 4px;
  margin-top: 6px;
}

.toast-die {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 22px;
  height: 22px;
  padding: 0 4px;
  border-radius: 4px;
  font-family: var(--font-cinzel);
  font-weight: 900;
  font-size: 11px;
  background: rgba(0,0,0,0.35);
  border: 1px solid rgba(200,190,170,0.15);
  color: var(--color-bone);
  opacity: 0;
  animation: toast-die-pop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  animation-delay: var(--die-delay, 0ms);
}

@keyframes toast-die-pop {
  0% {
    opacity: 0;
    transform: scale(0) rotate(-20deg);
  }
  100% {
    opacity: 1;
    transform: scale(1) rotate(0);
  }
}

.toast-die-crit {
  background: linear-gradient(135deg, rgba(200,168,78,0.3) 0%, rgba(200,168,78,0.15) 100%) !important;
  border-color: var(--color-gold) !important;
  color: var(--color-gold-bright) !important;
  box-shadow: 0 0 8px rgba(200,168,78,0.4);
  animation: toast-die-crit-pop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards !important;
}

@keyframes toast-die-crit-pop {
  0% {
    opacity: 0;
    transform: scale(0) rotate(-180deg);
  }
  50% {
    transform: scale(1.4) rotate(20deg);
    box-shadow: 0 0 20px rgba(200,168,78,0.8);
  }
  100% {
    opacity: 1;
    transform: scale(1) rotate(0);
    box-shadow: 0 0 8px rgba(200,168,78,0.4);
  }
}

.toast-die-fail {
  background: rgba(204,34,34,0.25) !important;
  border-color: var(--color-blood-bright) !important;
  color: var(--color-blood-bright) !important;
}

.toast-die-more {
  font-family: var(--font-garamond);
  font-size: 10px;
  color: var(--color-faded);
  margin-left: 2px;
}

.toast-equals {
  color: var(--color-dim);
  font-size: 10px;
  margin: 0 2px;
  opacity: 0;
  animation: toast-fade-in 0.2s ease-out 0.4s forwards;
}

.toast-total {
  font-family: var(--font-cinzel);
  font-size: 16px;
  font-weight: 900;
  color: var(--color-bone);
  text-shadow: 0 1px 3px rgba(0,0,0,0.5);
  opacity: 0;
  animation: toast-total-pop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) 0.35s forwards;
}

@keyframes toast-total-pop {
  0% {
    opacity: 0;
    transform: scale(0.5);
  }
  60% {
    transform: scale(1.2);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

.toast-total-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 15px rgba(232,208,104,0.6);
  font-size: 20px;
}

.toast-total-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 10px rgba(204,34,34,0.5);
}

@keyframes toast-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ── Результат справа (большой) ───────────────────────────── */

.toast-result {
  font-family: var(--font-cinzel);
  font-size: 28px;
  font-weight: 900;
  color: var(--color-bone);
  text-shadow: 0 2px 4px rgba(0,0,0,0.5);
  flex-shrink: 0;
  opacity: 0;
  animation: toast-result-pop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.2s forwards;
}

@keyframes toast-result-pop {
  0% {
    opacity: 0;
    transform: scale(0.3) rotate(-10deg);
  }
  50% {
    transform: scale(1.2) rotate(5deg);
  }
  100% {
    opacity: 1;
    transform: scale(1) rotate(0);
  }
}

.toast-result-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 20px rgba(232,208,104,0.6);
  font-size: 32px;
}

.toast-result-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 15px rgba(204,34,34,0.5);
}

/* ── HP бар ───────────────────────────────────────────────── */

.toast-hp {
  position: relative;
  height: 12px;
  border-radius: 6px;
  overflow: hidden;
  margin-top: 8px;
  background: rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.08);
}

.toast-hp-fill {
  position: absolute;
  left: 0; top: 0; bottom: 0;
  border-radius: 6px;
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.toast-hp-damage {
  background: linear-gradient(90deg, #cc2222, #881414);
  animation: toast-hp-damage-pulse 0.5s ease-out;
}

@keyframes toast-hp-damage-pulse {
  0% { filter: brightness(2); }
  100% { filter: brightness(1); }
}

.toast-hp-heal {
  background: linear-gradient(90deg, #22cc44, #118822);
  animation: toast-hp-heal-glow 0.6s ease-out;
}

@keyframes toast-hp-heal-glow {
  0% { box-shadow: 0 0 20px rgba(34,204,68,0.8); }
  100% { box-shadow: none; }
}

.toast-hp-text {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-cinzel);
  font-size: 9px;
  font-weight: 700;
  color: #fff;
  text-shadow: 0 1px 3px rgba(0,0,0,0.8);
  z-index: 2;
}

/* ── Детали ───────────────────────────────────────────────── */

.toast-details {
  margin-top: 6px;
  padding-top: 6px;
  border-top: 1px solid rgba(255,255,255,0.06);
}

.toast-detail-line {
  font-family: var(--font-garamond);
  font-size: 10px;
  color: var(--color-faded);
  line-height: 1.4;
  opacity: 0;
  animation: toast-text-slide 0.3s ease-out forwards;
  animation-delay: calc(0.3s + var(--line-index, 0) * 0.05s);
}

/* ── Баннер ───────────────────────────────────────────────── */

.toast-banner {
  text-align: center;
  font-family: var(--font-cinzel);
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  padding: 6px 0 2px;
  margin-top: 8px;
  border-top: 1px solid rgba(255,255,255,0.08);
  position: relative;
  z-index: 2;
}

.toast-banner-crit {
  color: var(--color-gold-bright);
  text-shadow: 0 0 10px rgba(232,208,104,0.5);
  animation: toast-banner-crit-flash 0.8s ease-out;
}

@keyframes toast-banner-crit-flash {
  0% {
    opacity: 0;
    letter-spacing: 0.4em;
    transform: scaleX(1.5);
  }
  30% {
    opacity: 1;
    text-shadow: 0 0 30px rgba(232,208,104,1);
  }
  100% {
    letter-spacing: 0.15em;
    transform: scaleX(1);
    text-shadow: 0 0 10px rgba(232,208,104,0.5);
  }
}

.toast-banner-fail {
  color: var(--color-blood-bright);
  text-shadow: 0 0 8px rgba(204,34,34,0.5);
  animation: toast-banner-fail-shake 0.5s ease-out;
}

@keyframes toast-banner-fail-shake {
  0%, 100% { transform: translateX(0); }
  20% { transform: translateX(-3px); }
  40% { transform: translateX(3px); }
  60% { transform: translateX(-2px); }
  80% { transform: translateX(1px); }
}

/* ── Прогресс-бар автозакрытия ────────────────────────────── */

.toast-progress {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--color-gold-dark), var(--color-gold));
  width: 100%;
  transform-origin: left;
  animation: toast-progress-shrink 4s linear forwards;
  opacity: 0.5;
}

@keyframes toast-progress-shrink {
  from { transform: scaleX(1); }
  to { transform: scaleX(0); }
}

.toast-crit .toast-progress {
  background: linear-gradient(90deg, var(--color-gold), var(--color-gold-bright));
  opacity: 0.8;
  height: 3px;
}

.toast-fail .toast-progress {
  background: linear-gradient(90deg, var(--color-blood), var(--color-blood-bright));
}

/* ── Адаптация для мобильных ──────────────────────────────── */

@media (max-width: 400px) {
  .dice-toast-container {
    max-width: 280px;
    right: 8px;
    bottom: 8px;
  }
  
  .dice-toast {
    padding: 8px 12px;
  }
  
  .toast-icon {
    font-size: 20px;
  }
  
  .toast-title {
    font-size: 12px;
  }
  
  .toast-die {
    min-width: 20px;
    height: 20px;
    font-size: 10px;
  }
  
  .toast-total {
    font-size: 14px;
  }
}

/* ══════════════════════════════════════════════════════════════
   TOAST OVERLAY — Отдельное окно для уведомлений
   ══════════════════════════════════════════════════════════════ */

.toast-overlay-root {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column-reverse;
  align-items: flex-end;
  justify-content: flex-start;
  padding: 8px;
  gap: 8px;
  pointer-events: none;
  overflow: hidden;
  background: transparent;
}

/* ── Карточка toast ───────────────────────────────────────── */

.dice-toast-card {
  width: 100%;
  max-width: 340px;
  border-radius: 14px;
  padding: 12px 16px;
  position: relative;
  overflow: hidden;
  pointer-events: auto;
  cursor: pointer;
  backdrop-filter: blur(20px);
  transform-origin: right bottom;
  
  box-shadow: 
    0 8px 32px rgba(0,0,0,0.5),
    0 2px 8px rgba(0,0,0,0.3),
    inset 0 1px 0 rgba(255,255,255,0.08);
}

.dice-toast-card:hover {
  transform: scale(1.02) translateX(-4px) !important;
}

.dice-toast-card:active {
  transform: scale(0.98) !important;
}

/* ── Glow ─────────────────────────────────────────────────── */

.dt-glow {
  position: absolute;
  inset: -100%;
  opacity: 0.2;
  pointer-events: none;
  transition: opacity 0.3s;
}

.dice-toast-card:hover .dt-glow {
  opacity: 0.35;
}

/* ── Цвета ────────────────────────────────────────────────── */

.dt-gold {
  background: linear-gradient(145deg, rgba(36,28,12,0.97) 0%, rgba(22,18,8,0.98) 100%);
  border: 1px solid rgba(200,168,78,0.4);
}
.dt-gold .dt-glow { background: radial-gradient(ellipse, rgba(200,168,78,0.5) 0%, transparent 70%); }

.dt-blood {
  background: linear-gradient(145deg, rgba(36,12,12,0.97) 0%, rgba(22,8,8,0.98) 100%);
  border: 1px solid rgba(204,34,34,0.4);
}
.dt-blood .dt-glow { background: radial-gradient(ellipse, rgba(204,34,34,0.5) 0%, transparent 70%); }

.dt-mana {
  background: linear-gradient(145deg, rgba(12,22,36,0.97) 0%, rgba(8,16,26,0.98) 100%);
  border: 1px solid rgba(68,153,221,0.4);
}
.dt-mana .dt-glow { background: radial-gradient(ellipse, rgba(68,153,221,0.5) 0%, transparent 70%); }

.dt-green {
  background: linear-gradient(145deg, rgba(12,36,12,0.97) 0%, rgba(8,22,8,0.98) 100%);
  border: 1px solid rgba(68,204,68,0.4);
}
.dt-green .dt-glow { background: radial-gradient(ellipse, rgba(68,204,68,0.5) 0%, transparent 70%); }

.dt-purple {
  background: linear-gradient(145deg, rgba(28,12,36,0.97) 0%, rgba(18,8,22,0.98) 100%);
  border: 1px solid rgba(150,80,220,0.4);
}
.dt-purple .dt-glow { background: radial-gradient(ellipse, rgba(150,80,220,0.5) 0%, transparent 70%); }

.dt-white {
  background: linear-gradient(145deg, rgba(28,28,32,0.97) 0%, rgba(18,18,22,0.98) 100%);
  border: 1px solid rgba(200,190,170,0.25);
}
.dt-white .dt-glow { background: radial-gradient(ellipse, rgba(200,190,170,0.3) 0%, transparent 70%); }

/* ── Анимации появления ───────────────────────────────────── */

.dt-enter {
  opacity: 0;
  transform: translateX(120%) scale(0.7) rotateZ(8deg);
}

.dt-visible {
  opacity: 1;
  transform: translateX(0) scale(1) rotateZ(0deg);
  transition: 
    opacity 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
    transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.dt-exit {
  opacity: 0;
  transform: translateX(80%) scale(0.85) rotateZ(-4deg);
  transition: 
    opacity 0.5s ease-out,
    transform 0.5s ease-out;
}

/* ── Крит эффекты ─────────────────────────────────────────── */

.dt-crit {
  border-color: var(--color-gold) !important;
  box-shadow: 
    0 8px 32px rgba(0,0,0,0.5),
    0 0 40px rgba(232,208,104,0.3),
    0 0 80px rgba(232,208,104,0.15),
    inset 0 0 30px rgba(232,208,104,0.08) !important;
  animation: dt-crit-entrance 0.7s ease-out;
}

@keyframes dt-crit-entrance {
  0% {
    transform: translateX(150%) scale(0.4) rotateZ(20deg);
    filter: brightness(2.5);
  }
  40% {
    transform: translateX(-15px) scale(1.15) rotateZ(-5deg);
    filter: brightness(1.8);
  }
  70% {
    transform: translateX(8px) scale(1.05);
    filter: brightness(1.2);
  }
  100% {
    transform: translateX(0) scale(1) rotateZ(0);
    filter: brightness(1);
  }
}

.dt-crit-rays {
  position: absolute;
  inset: -300%;
  background: conic-gradient(
    from 0deg,
    transparent 0deg, rgba(232,208,104,0.1) 5deg, transparent 10deg,
    transparent 18deg, rgba(232,208,104,0.08) 23deg, transparent 28deg,
    transparent 36deg, rgba(232,208,104,0.1) 41deg, transparent 46deg,
    transparent 54deg, rgba(232,208,104,0.06) 59deg, transparent 64deg,
    transparent 72deg, rgba(232,208,104,0.09) 77deg, transparent 82deg
  );
  animation: dt-rays-spin 10s linear infinite;
  pointer-events: none;
}

@keyframes dt-rays-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ── Провал эффекты ───────────────────────────────────────── */

.dt-fail {
  border-color: var(--color-blood-bright) !important;
  box-shadow: 
    0 8px 32px rgba(0,0,0,0.5),
    0 0 25px rgba(204,34,34,0.25) !important;
  animation: dt-fail-entrance 0.5s ease-out;
}

@keyframes dt-fail-entrance {
  0% { transform: translateX(100%) scale(0.9); }
  15% { transform: translateX(-8px) scale(1.03); }
  30% { transform: translateX(6px); }
  45% { transform: translateX(-4px); }
  60% { transform: translateX(3px); }
  75% { transform: translateX(-1px); }
  100% { transform: translateX(0) scale(1); }
}

.dt-fail-cracks {
  position: absolute;
  inset: 0;
  background:
    linear-gradient(115deg, transparent 38%, rgba(204,34,34,0.2) 43%, transparent 48%),
    linear-gradient(245deg, transparent 40%, rgba(204,34,34,0.15) 45%, transparent 50%),
    linear-gradient(65deg, transparent 42%, rgba(204,34,34,0.1) 46%, transparent 50%);
  pointer-events: none;
  animation: dt-cracks-appear 0.4s ease-out 0.15s both;
}

@keyframes dt-cracks-appear {
  from { opacity: 0; transform: scale(1.1); }
  to { opacity: 1; transform: scale(1); }
}

/* ── Контент ──────────────────────────────────────────────── */

.dt-content {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  position: relative;
  z-index: 2;
}

/* Иконка */
.dt-icon {
  font-size: 28px;
  flex-shrink: 0;
  line-height: 1;
  filter: drop-shadow(0 3px 6px rgba(0,0,0,0.5));
  animation: dt-icon-pop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s both;
}

@keyframes dt-icon-pop {
  0% { transform: scale(0) rotate(-60deg); opacity: 0; }
  60% { transform: scale(1.2) rotate(10deg); }
  100% { transform: scale(1) rotate(0); opacity: 1; }
}

.dt-icon-crit {
  font-size: 34px;
  animation: dt-icon-crit-pop 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) both;
  filter: drop-shadow(0 0 12px rgba(232,208,104,0.7));
}

@keyframes dt-icon-crit-pop {
  0% { transform: scale(0) rotate(-180deg); opacity: 0; }
  40% { transform: scale(1.4) rotate(25deg); }
  70% { transform: scale(0.9) rotate(-10deg); }
  100% { transform: scale(1) rotate(0); opacity: 1; }
}

.dt-icon-fail {
  animation: dt-icon-fail-shake 0.6s ease-out both;
}

@keyframes dt-icon-fail-shake {
  0%, 100% { transform: translateX(0) rotate(0); }
  15% { transform: translateX(-6px) rotate(-8deg); }
  30% { transform: translateX(6px) rotate(8deg); }
  45% { transform: translateX(-5px) rotate(-5deg); }
  60% { transform: translateX(4px) rotate(4deg); }
  75% { transform: translateX(-2px) rotate(-2deg); }
}

/* Тело */
.dt-body {
  flex: 1;
  min-width: 0;
}

.dt-unit {
  font-family: var(--font-cinzel);
  font-size: 10px;
  font-weight: 700;
  color: var(--color-faded);
  text-transform: uppercase;
  letter-spacing: 0.12em;
  margin-bottom: 2px;
  opacity: 0;
  animation: dt-text-slide 0.35s ease-out 0.15s forwards;
}

.dt-title {
  font-family: var(--font-cinzel);
  font-size: 14px;
  font-weight: 700;
  color: var(--color-bone);
  line-height: 1.25;
  opacity: 0;
  animation: dt-text-slide 0.35s ease-out 0.2s forwards;
}

.dt-title-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 12px rgba(232,208,104,0.6);
  font-size: 16px;
}

.dt-title-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 10px rgba(204,34,34,0.5);
}

.dt-subtitle {
  font-family: var(--font-garamond);
  font-size: 12px;
  color: var(--color-ancient);
  font-style: italic;
  margin-top: 3px;
  opacity: 0;
  animation: dt-text-slide 0.35s ease-out 0.25s forwards;
}

@keyframes dt-text-slide {
  from { opacity: 0; transform: translateX(-15px); }
  to { opacity: 1; transform: translateX(0); }
}

/* ── Кубики ───────────────────────────────────────────────── */

.dt-rolls {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 5px;
  margin-top: 8px;
}

.dt-die {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 26px;
  height: 26px;
  padding: 0 5px;
  border-radius: 5px;
  font-family: var(--font-cinzel);
  font-weight: 900;
  font-size: 12px;
  background: rgba(0,0,0,0.4);
  border: 1px solid rgba(200,190,170,0.2);
  color: var(--color-bone);
  opacity: 0;
  animation: dt-die-pop 0.35s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  animation-delay: calc(0.2s + var(--die-i, 0) * 0.06s);
}

@keyframes dt-die-pop {
  0% { opacity: 0; transform: scale(0) rotate(-30deg); }
  70% { transform: scale(1.15) rotate(5deg); }
  100% { opacity: 1; transform: scale(1) rotate(0); }
}

.dt-die-crit {
  background: linear-gradient(135deg, rgba(200,168,78,0.4) 0%, rgba(200,168,78,0.2) 100%) !important;
  border-color: var(--color-gold) !important;
  color: var(--color-gold-bright) !important;
  box-shadow: 0 0 12px rgba(200,168,78,0.5);
  animation: dt-die-crit-pop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards !important;
}

@keyframes dt-die-crit-pop {
  0% { opacity: 0; transform: scale(0) rotate(-180deg); }
  40% { transform: scale(1.5) rotate(30deg); box-shadow: 0 0 30px rgba(200,168,78,1); }
  70% { transform: scale(0.9) rotate(-10deg); }
  100% { opacity: 1; transform: scale(1) rotate(0); box-shadow: 0 0 12px rgba(200,168,78,0.5); }
}

.dt-die-fail {
  background: rgba(204,34,34,0.3) !important;
  border-color: var(--color-blood-bright) !important;
  color: var(--color-blood-bright) !important;
}

.dt-die-more {
  font-family: var(--font-garamond);
  font-size: 11px;
  color: var(--color-faded);
  margin-left: 3px;
}

.dt-eq {
  color: var(--color-dim);
  font-size: 12px;
  margin: 0 3px;
  opacity: 0;
  animation: dt-fade-in 0.25s ease-out 0.5s forwards;
}

.dt-total {
  font-family: var(--font-cinzel);
  font-size: 20px;
  font-weight: 900;
  color: var(--color-bone);
  text-shadow: 0 2px 4px rgba(0,0,0,0.6);
  opacity: 0;
  animation: dt-total-pop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.45s forwards;
}

@keyframes dt-total-pop {
  0% { opacity: 0; transform: scale(0.4); }
  50% { transform: scale(1.3); }
  100% { opacity: 1; transform: scale(1); }
}

.dt-total-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 20px rgba(232,208,104,0.7);
  font-size: 24px;
}

.dt-total-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 12px rgba(204,34,34,0.6);
}

@keyframes dt-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ── Результат справа ─────────────────────────────────────── */

.dt-result {
  font-family: var(--font-cinzel);
  font-size: 32px;
  font-weight: 900;
  color: var(--color-bone);
  text-shadow: 0 3px 6px rgba(0,0,0,0.6);
  flex-shrink: 0;
  opacity: 0;
  animation: dt-result-pop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.2s forwards;
}

@keyframes dt-result-pop {
  0% { opacity: 0; transform: scale(0.2) rotate(-15deg); }
  40% { transform: scale(1.3) rotate(8deg); }
  70% { transform: scale(0.95) rotate(-3deg); }
  100% { opacity: 1; transform: scale(1) rotate(0); }
}

.dt-result-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 25px rgba(232,208,104,0.7);
  font-size: 38px;
}

.dt-result-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 18px rgba(204,34,34,0.6);
}

/* ── HP бар ───────────────────────────────────────────────── */

.dt-hp {
  position: relative;
  height: 14px;
  border-radius: 7px;
  overflow: hidden;
  margin-top: 10px;
  background: rgba(0,0,0,0.4);
  border: 1px solid rgba(255,255,255,0.1);
}

.dt-hp-fill {
  position: absolute;
  left: 0; top: 0; bottom: 0;
  border-radius: 7px;
  transition: width 0.7s cubic-bezier(0.4, 0, 0.2, 1);
}

.dt-hp-dmg {
  background: linear-gradient(90deg, #cc2222, #881414);
  animation: dt-hp-dmg-pulse 0.6s ease-out;
}

@keyframes dt-hp-dmg-pulse {
  0% { filter: brightness(2.5); }
  50% { filter: brightness(1.5); }
  100% { filter: brightness(1); }
}

.dt-hp-heal {
  background: linear-gradient(90deg, #22cc44, #118822);
  animation: dt-hp-heal-glow 0.7s ease-out;
}

@keyframes dt-hp-heal-glow {
  0% { box-shadow: 0 0 30px rgba(34,204,68,0.9); }
  50% { box-shadow: 0 0 15px rgba(34,204,68,0.5); }
  100% { box-shadow: none; }
}

.dt-hp-txt {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-cinzel);
  font-size: 10px;
  font-weight: 700;
  color: #fff;
  text-shadow: 0 1px 4px rgba(0,0,0,0.9);
  z-index: 2;
}

/* ── Детали ───────────────────────────────────────────────── */

.dt-details {
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid rgba(255,255,255,0.08);
}

.dt-detail-line {
  font-family: var(--font-garamond);
  font-size: 11px;
  color: var(--color-faded);
  line-height: 1.45;
}

/* ── Баннер ───────────────────────────────────────────────── */

.dt-banner {
  text-align: center;
  font-family: var(--font-cinzel);
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  padding: 8px 0 3px;
  margin-top: 10px;
  border-top: 1px solid rgba(255,255,255,0.1);
  position: relative;
  z-index: 2;
}

.dt-banner-crit {
  color: var(--color-gold-bright);
  text-shadow: 0 0 15px rgba(232,208,104,0.6);
  animation: dt-banner-crit-flash 1s ease-out;
}

@keyframes dt-banner-crit-flash {
  0% {
    opacity: 0;
    letter-spacing: 0.5em;
    transform: scaleX(1.8);
    text-shadow: 0 0 40px rgba(232,208,104,1);
  }
  30% {
    opacity: 1;
    text-shadow: 0 0 50px rgba(232,208,104,1);
  }
  100% {
    letter-spacing: 0.18em;
    transform: scaleX(1);
    text-shadow: 0 0 15px rgba(232,208,104,0.6);
  }
}

.dt-banner-fail {
  color: var(--color-blood-bright);
  text-shadow: 0 0 10px rgba(204,34,34,0.6);
  animation: dt-banner-fail-shake 0.6s ease-out;
}

@keyframes dt-banner-fail-shake {
  0%, 100% { transform: translateX(0); }
  15% { transform: translateX(-5px); }
  30% { transform: translateX(5px); }
  45% { transform: translateX(-4px); }
  60% { transform: translateX(3px); }
  75% { transform: translateX(-2px); }
}

/* ── Прогресс-бар ─────────────────────────────────────────── */

.dt-progress {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--color-gold-dark), var(--color-gold));
  width: 100%;
  transform-origin: left;
  animation: dt-progress-shrink 5s linear forwards;
  opacity: 0.6;
  border-radius: 0 0 14px 14px;
}

@keyframes dt-progress-shrink {
  from { transform: scaleX(1); }
  to { transform: scaleX(0); }
}

.dt-crit .dt-progress {
  background: linear-gradient(90deg, var(--color-gold), var(--color-gold-bright));
  opacity: 0.9;
  height: 4px;
  box-shadow: 0 0 10px rgba(232,208,104,0.5);
}

.dt-fail .dt-progress {
  background: linear-gradient(90deg, var(--color-blood), var(--color-blood-bright));
}

/* ══════════════════════════════════════════════════════════════
   TOAST OVERLAY — Отдельное окно для уведомлений
   ══════════════════════════════════════════════════════════════ */

.toast-overlay-root {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column-reverse;
  align-items: flex-end;
  justify-content: flex-start;
  padding: 8px;
  gap: 8px;
  pointer-events: none;
  overflow: hidden;
  background: transparent !important;
  font-family: var(--font-garamond);
}

/* Debug info */
.toast-debug {
  position: absolute;
  bottom: 8px;
  right: 8px;
  pointer-events: none;
}

.toast-debug-status {
  font-size: 10px;
  color: var(--color-faded);
  background: rgba(0,0,0,0.5);
  padding: 4px 8px;
  border-radius: 4px;
  backdrop-filter: blur(4px);
}

/* ── Карточка toast ───────────────────────────────────────── */

.dice-toast-card {
  width: 100%;
  max-width: 340px;
  border-radius: 14px;
  padding: 12px 16px;
  position: relative;
  overflow: hidden;
  pointer-events: auto;
  cursor: pointer;
  backdrop-filter: blur(20px);
  transform-origin: right bottom;
  
  box-shadow: 
    0 8px 32px rgba(0,0,0,0.5),
    0 2px 8px rgba(0,0,0,0.3),
    inset 0 1px 0 rgba(255,255,255,0.08);
}

.dice-toast-card:hover {
  transform: scale(1.02) translateX(-4px) !important;
}

.dice-toast-card:active {
  transform: scale(0.98) !important;
}

/* ── Glow ─────────────────────────────────────────────────── */

.dt-glow {
  position: absolute;
  inset: -100%;
  opacity: 0.2;
  pointer-events: none;
  transition: opacity 0.3s;
}

.dice-toast-card:hover .dt-glow {
  opacity: 0.35;
}

/* ── Цвета ────────────────────────────────────────────────── */

.dt-gold {
  background: linear-gradient(145deg, rgba(36,28,12,0.97) 0%, rgba(22,18,8,0.98) 100%);
  border: 1px solid rgba(200,168,78,0.4);
}
.dt-gold .dt-glow { background: radial-gradient(ellipse, rgba(200,168,78,0.5) 0%, transparent 70%); }

.dt-blood {
  background: linear-gradient(145deg, rgba(36,12,12,0.97) 0%, rgba(22,8,8,0.98) 100%);
  border: 1px solid rgba(204,34,34,0.4);
}
.dt-blood .dt-glow { background: radial-gradient(ellipse, rgba(204,34,34,0.5) 0%, transparent 70%); }

.dt-mana {
  background: linear-gradient(145deg, rgba(12,22,36,0.97) 0%, rgba(8,16,26,0.98) 100%);
  border: 1px solid rgba(68,153,221,0.4);
}
.dt-mana .dt-glow { background: radial-gradient(ellipse, rgba(68,153,221,0.5) 0%, transparent 70%); }

.dt-green {
  background: linear-gradient(145deg, rgba(12,36,12,0.97) 0%, rgba(8,22,8,0.98) 100%);
  border: 1px solid rgba(68,204,68,0.4);
}
.dt-green .dt-glow { background: radial-gradient(ellipse, rgba(68,204,68,0.5) 0%, transparent 70%); }

.dt-purple {
  background: linear-gradient(145deg, rgba(28,12,36,0.97) 0%, rgba(18,8,22,0.98) 100%);
  border: 1px solid rgba(150,80,220,0.4);
}
.dt-purple .dt-glow { background: radial-gradient(ellipse, rgba(150,80,220,0.5) 0%, transparent 70%); }

.dt-white {
  background: linear-gradient(145deg, rgba(28,28,32,0.97) 0%, rgba(18,18,22,0.98) 100%);
  border: 1px solid rgba(200,190,170,0.25);
}
.dt-white .dt-glow { background: radial-gradient(ellipse, rgba(200,190,170,0.3) 0%, transparent 70%); }

/* ── Анимации появления ───────────────────────────────────── */

.dt-enter {
  opacity: 0;
  transform: translateX(120%) scale(0.7) rotateZ(8deg);
}

.dt-visible {
  opacity: 1;
  transform: translateX(0) scale(1) rotateZ(0deg);
  transition: 
    opacity 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
    transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.dt-exit {
  opacity: 0;
  transform: translateX(80%) scale(0.85) rotateZ(-4deg);
  transition: 
    opacity 0.5s ease-out,
    transform 0.5s ease-out;
}

/* ── Крит эффекты ─────────────────────────────────────────── */

.dt-crit {
  border-color: var(--color-gold) !important;
  box-shadow: 
    0 8px 32px rgba(0,0,0,0.5),
    0 0 40px rgba(232,208,104,0.3),
    0 0 80px rgba(232,208,104,0.15),
    inset 0 0 30px rgba(232,208,104,0.08) !important;
  animation: dt-crit-entrance 0.7s ease-out;
}

@keyframes dt-crit-entrance {
  0% {
    transform: translateX(150%) scale(0.4) rotateZ(20deg);
    filter: brightness(2.5);
  }
  40% {
    transform: translateX(-15px) scale(1.15) rotateZ(-5deg);
    filter: brightness(1.8);
  }
  70% {
    transform: translateX(8px) scale(1.05);
    filter: brightness(1.2);
  }
  100% {
    transform: translateX(0) scale(1) rotateZ(0);
    filter: brightness(1);
  }
}

.dt-crit-rays {
  position: absolute;
  inset: -300%;
  background: conic-gradient(
    from 0deg,
    transparent 0deg, rgba(232,208,104,0.1) 5deg, transparent 10deg,
    transparent 18deg, rgba(232,208,104,0.08) 23deg, transparent 28deg,
    transparent 36deg, rgba(232,208,104,0.1) 41deg, transparent 46deg,
    transparent 54deg, rgba(232,208,104,0.06) 59deg, transparent 64deg,
    transparent 72deg, rgba(232,208,104,0.09) 77deg, transparent 82deg
  );
  animation: dt-rays-spin 10s linear infinite;
  pointer-events: none;
}

@keyframes dt-rays-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ── Провал эффекты ───────────────────────────────────────── */

.dt-fail {
  border-color: var(--color-blood-bright) !important;
  box-shadow: 
    0 8px 32px rgba(0,0,0,0.5),
    0 0 25px rgba(204,34,34,0.25) !important;
  animation: dt-fail-entrance 0.5s ease-out;
}

@keyframes dt-fail-entrance {
  0% { transform: translateX(100%) scale(0.9); }
  15% { transform: translateX(-8px) scale(1.03); }
  30% { transform: translateX(6px); }
  45% { transform: translateX(-4px); }
  60% { transform: translateX(3px); }
  75% { transform: translateX(-1px); }
  100% { transform: translateX(0) scale(1); }
}

.dt-fail-cracks {
  position: absolute;
  inset: 0;
  background:
    linear-gradient(115deg, transparent 38%, rgba(204,34,34,0.2) 43%, transparent 48%),
    linear-gradient(245deg, transparent 40%, rgba(204,34,34,0.15) 45%, transparent 50%),
    linear-gradient(65deg, transparent 42%, rgba(204,34,34,0.1) 46%, transparent 50%);
  pointer-events: none;
  animation: dt-cracks-appear 0.4s ease-out 0.15s both;
}

@keyframes dt-cracks-appear {
  from { opacity: 0; transform: scale(1.1); }
  to { opacity: 1; transform: scale(1); }
}

/* ── Контент ──────────────────────────────────────────────── */

.dt-content {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  position: relative;
  z-index: 2;
}

/* Иконка */
.dt-icon {
  font-size: 28px;
  flex-shrink: 0;
  line-height: 1;
  filter: drop-shadow(0 3px 6px rgba(0,0,0,0.5));
  animation: dt-icon-pop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s both;
}

@keyframes dt-icon-pop {
  0% { transform: scale(0) rotate(-60deg); opacity: 0; }
  60% { transform: scale(1.2) rotate(10deg); }
  100% { transform: scale(1) rotate(0); opacity: 1; }
}

.dt-icon-crit {
  font-size: 34px;
  animation: dt-icon-crit-pop 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) both;
  filter: drop-shadow(0 0 12px rgba(232,208,104,0.7));
}

@keyframes dt-icon-crit-pop {
  0% { transform: scale(0) rotate(-180deg); opacity: 0; }
  40% { transform: scale(1.4) rotate(25deg); }
  70% { transform: scale(0.9) rotate(-10deg); }
  100% { transform: scale(1) rotate(0); opacity: 1; }
}

.dt-icon-fail {
  animation: dt-icon-fail-shake 0.6s ease-out both;
}

@keyframes dt-icon-fail-shake {
  0%, 100% { transform: translateX(0) rotate(0); }
  15% { transform: translateX(-6px) rotate(-8deg); }
  30% { transform: translateX(6px) rotate(8deg); }
  45% { transform: translateX(-5px) rotate(-5deg); }
  60% { transform: translateX(4px) rotate(4deg); }
  75% { transform: translateX(-2px) rotate(-2deg); }
}

/* Тело */
.dt-body {
  flex: 1;
  min-width: 0;
}

.dt-unit {
  font-family: var(--font-cinzel);
  font-size: 10px;
  font-weight: 700;
  color: var(--color-faded);
  text-transform: uppercase;
  letter-spacing: 0.12em;
  margin-bottom: 2px;
  opacity: 0;
  animation: dt-text-slide 0.35s ease-out 0.15s forwards;
}

.dt-title {
  font-family: var(--font-cinzel);
  font-size: 14px;
  font-weight: 700;
  color: var(--color-bone);
  line-height: 1.25;
  opacity: 0;
  animation: dt-text-slide 0.35s ease-out 0.2s forwards;
}

.dt-title-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 12px rgba(232,208,104,0.6);
  font-size: 16px;
}

.dt-title-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 10px rgba(204,34,34,0.5);
}

.dt-subtitle {
  font-family: var(--font-garamond);
  font-size: 12px;
  color: var(--color-ancient);
  font-style: italic;
  margin-top: 3px;
  opacity: 0;
  animation: dt-text-slide 0.35s ease-out 0.25s forwards;
}

@keyframes dt-text-slide {
  from { opacity: 0; transform: translateX(-15px); }
  to { opacity: 1; transform: translateX(0); }
}

/* ── Кубики ───────────────────────────────────────────────── */

.dt-rolls {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 5px;
  margin-top: 8px;
}

.dt-die {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 26px;
  height: 26px;
  padding: 0 5px;
  border-radius: 5px;
  font-family: var(--font-cinzel);
  font-weight: 900;
  font-size: 12px;
  background: rgba(0,0,0,0.4);
  border: 1px solid rgba(200,190,170,0.2);
  color: var(--color-bone);
  opacity: 0;
  animation: dt-die-pop 0.35s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  animation-delay: calc(0.2s + var(--die-i, 0) * 0.06s);
}

@keyframes dt-die-pop {
  0% { opacity: 0; transform: scale(0) rotate(-30deg); }
  70% { transform: scale(1.15) rotate(5deg); }
  100% { opacity: 1; transform: scale(1) rotate(0); }
}

.dt-die-crit {
  background: linear-gradient(135deg, rgba(200,168,78,0.4) 0%, rgba(200,168,78,0.2) 100%) !important;
  border-color: var(--color-gold) !important;
  color: var(--color-gold-bright) !important;
  box-shadow: 0 0 12px rgba(200,168,78,0.5);
  animation: dt-die-crit-pop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards !important;
}

@keyframes dt-die-crit-pop {
  0% { opacity: 0; transform: scale(0) rotate(-180deg); }
  40% { transform: scale(1.5) rotate(30deg); box-shadow: 0 0 30px rgba(200,168,78,1); }
  70% { transform: scale(0.9) rotate(-10deg); }
  100% { opacity: 1; transform: scale(1) rotate(0); box-shadow: 0 0 12px rgba(200,168,78,0.5); }
}

.dt-die-fail {
  background: rgba(204,34,34,0.3) !important;
  border-color: var(--color-blood-bright) !important;
  color: var(--color-blood-bright) !important;
}

.dt-die-more {
  font-family: var(--font-garamond);
  font-size: 11px;
  color: var(--color-faded);
  margin-left: 3px;
}

.dt-eq {
  color: var(--color-dim);
  font-size: 12px;
  margin: 0 3px;
  opacity: 0;
  animation: dt-fade-in 0.25s ease-out 0.5s forwards;
}

.dt-total {
  font-family: var(--font-cinzel);
  font-size: 20px;
  font-weight: 900;
  color: var(--color-bone);
  text-shadow: 0 2px 4px rgba(0,0,0,0.6);
  opacity: 0;
  animation: dt-total-pop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.45s forwards;
}

@keyframes dt-total-pop {
  0% { opacity: 0; transform: scale(0.4); }
  50% { transform: scale(1.3); }
  100% { opacity: 1; transform: scale(1); }
}

.dt-total-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 20px rgba(232,208,104,0.7);
  font-size: 24px;
}

.dt-total-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 12px rgba(204,34,34,0.6);
}

@keyframes dt-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ── Результат справа ─────────────────────────────────────── */

.dt-result {
  font-family: var(--font-cinzel);
  font-size: 32px;
  font-weight: 900;
  color: var(--color-bone);
  text-shadow: 0 3px 6px rgba(0,0,0,0.6);
  flex-shrink: 0;
  opacity: 0;
  animation: dt-result-pop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.2s forwards;
}

@keyframes dt-result-pop {
  0% { opacity: 0; transform: scale(0.2) rotate(-15deg); }
  40% { transform: scale(1.3) rotate(8deg); }
  70% { transform: scale(0.95) rotate(-3deg); }
  100% { opacity: 1; transform: scale(1) rotate(0); }
}

.dt-result-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 25px rgba(232,208,104,0.7);
  font-size: 38px;
}

.dt-result-fail {
  color: var(--color-blood-bright) !important;
  text-shadow: 0 0 18px rgba(204,34,34,0.6);
}

/* ── HP бар ───────────────────────────────────────────────── */

.dt-hp {
  position: relative;
  height: 14px;
  border-radius: 7px;
  overflow: hidden;
  margin-top: 10px;
  background: rgba(0,0,0,0.4);
  border: 1px solid rgba(255,255,255,0.1);
}

.dt-hp-fill {
  position: absolute;
  left: 0; top: 0; bottom: 0;
  border-radius: 7px;
  transition: width 0.7s cubic-bezier(0.4, 0, 0.2, 1);
}

.dt-hp-dmg {
  background: linear-gradient(90deg, #cc2222, #881414);
  animation: dt-hp-dmg-pulse 0.6s ease-out;
}

@keyframes dt-hp-dmg-pulse {
  0% { filter: brightness(2.5); }
  50% { filter: brightness(1.5); }
  100% { filter: brightness(1); }
}

.dt-hp-heal {
  background: linear-gradient(90deg, #22cc44, #118822);
  animation: dt-hp-heal-glow 0.7s ease-out;
}

@keyframes dt-hp-heal-glow {
  0% { box-shadow: 0 0 30px rgba(34,204,68,0.9); }
  50% { box-shadow: 0 0 15px rgba(34,204,68,0.5); }
  100% { box-shadow: none; }
}

.dt-hp-txt {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-cinzel);
  font-size: 10px;
  font-weight: 700;
  color: #fff;
  text-shadow: 0 1px 4px rgba(0,0,0,0.9);
  z-index: 2;
}

/* ── Детали ───────────────────────────────────────────────── */

.dt-details {
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid rgba(255,255,255,0.08);
}

.dt-detail-line {
  font-family: var(--font-garamond);
  font-size: 11px;
  color: var(--color-faded);
  line-height: 1.45;
}

/* ── Баннер ───────────────────────────────────────────────── */

.dt-banner {
  text-align: center;
  font-family: var(--font-cinzel);
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  padding: 8px 0 3px;
  margin-top: 10px;
  border-top: 1px solid rgba(255,255,255,0.1);
  position: relative;
  z-index: 2;
}

.dt-banner-crit {
  color: var(--color-gold-bright);
  text-shadow: 0 0 15px rgba(232,208,104,0.6);
  animation: dt-banner-crit-flash 1s ease-out;
}

@keyframes dt-banner-crit-flash {
  0% {
    opacity: 0;
    letter-spacing: 0.5em;
    transform: scaleX(1.8);
    text-shadow: 0 0 40px rgba(232,208,104,1);
  }
  30% {
    opacity: 1;
    text-shadow: 0 0 50px rgba(232,208,104,1);
  }
  100% {
    letter-spacing: 0.18em;
    transform: scaleX(1);
    text-shadow: 0 0 15px rgba(232,208,104,0.6);
  }
}

.dt-banner-fail {
  color: var(--color-blood-bright);
  text-shadow: 0 0 10px rgba(204,34,34,0.6);
  animation: dt-banner-fail-shake 0.6s ease-out;
}

@keyframes dt-banner-fail-shake {
  0%, 100% { transform: translateX(0); }
  15% { transform: translateX(-5px); }
  30% { transform: translateX(5px); }
  45% { transform: translateX(-4px); }
  60% { transform: translateX(3px); }
  75% { transform: translateX(-2px); }
}

/* ── Прогресс-бар ─────────────────────────────────────────── */

.dt-progress {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--color-gold-dark), var(--color-gold));
  width: 100%;
  transform-origin: left;
  animation: dt-progress-shrink 5s linear forwards;
  opacity: 0.6;
  border-radius: 0 0 14px 14px;
}

@keyframes dt-progress-shrink {
  from { transform: scaleX(1); }
  to { transform: scaleX(0); }
}

.dt-crit .dt-progress {
  background: linear-gradient(90deg, var(--color-gold), var(--color-gold-bright));
  opacity: 0.9;
  height: 4px;
  box-shadow: 0 0 10px rgba(232,208,104,0.5);
}

.dt-fail .dt-progress {
  background: linear-gradient(90deg, var(--color-blood), var(--color-blood-bright));
}

/* ══════════════════════════════════════════════════════════════
   MINI TOASTS — Компактные уведомления о бросках
   ══════════════════════════════════════════════════════════════ */

.dice-toasts-container {
  position: fixed;
  bottom: 32px;
  right: 8px;
  z-index: 150;
  display: flex;
  flex-direction: column-reverse;
  gap: 6px;
  pointer-events: none;
  max-width: 280px;
}

/* ── Mini Toast ───────────────────────────────────────────── */

.mini-toast {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 8px;
  pointer-events: auto;
  cursor: pointer;
  position: relative;
  overflow: hidden;
  backdrop-filter: blur(12px);
  
  box-shadow: 
    0 4px 16px rgba(0,0,0,0.4),
    inset 0 1px 0 rgba(255,255,255,0.06);
}

.mini-toast:hover {
  transform: translateX(-4px) scale(1.02);
}

.mini-toast:active {
  transform: scale(0.98);
}

/* ── Цвета ────────────────────────────────────────────────── */

.mt-gold {
  background: linear-gradient(135deg, rgba(32,26,12,0.92) 0%, rgba(18,14,6,0.95) 100%);
  border: 1px solid rgba(200,168,78,0.35);
}

.mt-blood {
  background: linear-gradient(135deg, rgba(32,12,12,0.92) 0%, rgba(18,6,6,0.95) 100%);
  border: 1px solid rgba(204,34,34,0.35);
}

.mt-mana {
  background: linear-gradient(135deg, rgba(12,20,32,0.92) 0%, rgba(6,12,20,0.95) 100%);
  border: 1px solid rgba(68,153,221,0.35);
}

.mt-green {
  background: linear-gradient(135deg, rgba(12,32,12,0.92) 0%, rgba(6,18,6,0.95) 100%);
  border: 1px solid rgba(68,204,68,0.35);
}

.mt-purple {
  background: linear-gradient(135deg, rgba(24,12,32,0.92) 0%, rgba(14,6,18,0.95) 100%);
  border: 1px solid rgba(150,80,220,0.35);
}

.mt-white {
  background: linear-gradient(135deg, rgba(24,24,28,0.92) 0%, rgba(14,14,18,0.95) 100%);
  border: 1px solid rgba(200,190,170,0.2);
}

/* ── Анимации ─────────────────────────────────────────────── */

.mt-enter {
  opacity: 0;
  transform: translateX(100%) scale(0.8);
}

.mt-visible {
  opacity: 1;
  transform: translateX(0) scale(1);
  transition: 
    opacity 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
    transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.mt-exit {
  opacity: 0;
  transform: translateX(60%) scale(0.9);
  transition: opacity 0.3s ease-out, transform 0.3s ease-out;
}

/* ── Крит ─────────────────────────────────────────────────── */

.mt-crit {
  border-color: var(--color-gold) !important;
  box-shadow: 
    0 4px 16px rgba(0,0,0,0.4),
    0 0 20px rgba(232,208,104,0.2) !important;
  animation: mt-crit-pop 0.5s ease-out;
}

@keyframes mt-crit-pop {
  0% { transform: translateX(100%) scale(0.5); filter: brightness(2); }
  50% { transform: translateX(-8px) scale(1.1); }
  100% { transform: translateX(0) scale(1); filter: brightness(1); }
}

/* ── Провал ───────────────────────────────────────────────── */

.mt-fail {
  border-color: var(--color-blood-bright) !important;
  animation: mt-fail-shake 0.4s ease-out;
}

@keyframes mt-fail-shake {
  0%, 100% { transform: translateX(0); }
  20% { transform: translateX(-6px); }
  40% { transform: translateX(6px); }
  60% { transform: translateX(-4px); }
  80% { transform: translateX(2px); }
}

/* ── Иконка ───────────────────────────────────────────────── */

.mt-icon {
  font-size: 18px;
  flex-shrink: 0;
  animation: mt-icon-pop 0.3s ease-out;
}

@keyframes mt-icon-pop {
  0% { transform: scale(0) rotate(-30deg); }
  100% { transform: scale(1) rotate(0); }
}

.mt-icon-crit {
  font-size: 22px;
  filter: drop-shadow(0 0 6px rgba(232,208,104,0.6));
  animation: mt-icon-crit-pop 0.5s ease-out;
}

@keyframes mt-icon-crit-pop {
  0% { transform: scale(0) rotate(-180deg); }
  60% { transform: scale(1.3) rotate(10deg); }
  100% { transform: scale(1) rotate(0); }
}

/* ── Текст ────────────────────────────────────────────────── */

.mt-text {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 4px;
}

.mt-unit {
  font-family: var(--font-cinzel);
  font-size: 9px;
  font-weight: 700;
  color: var(--color-faded);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.mt-title {
  font-family: var(--font-cinzel);
  font-size: 11px;
  font-weight: 700;
  color: var(--color-bone);
}

/* ── Кубики ───────────────────────────────────────────────── */

.mt-rolls {
  display: flex;
  align-items: center;
  gap: 3px;
  flex-shrink: 0;
}

.mt-die {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 18px;
  height: 18px;
  padding: 0 3px;
  border-radius: 3px;
  font-family: var(--font-cinzel);
  font-weight: 900;
  font-size: 10px;
  background: rgba(0,0,0,0.3);
  border: 1px solid rgba(200,190,170,0.15);
  color: var(--color-bone);
}

.mt-die-crit {
  background: rgba(200,168,78,0.25) !important;
  border-color: var(--color-gold) !important;
  color: var(--color-gold-bright) !important;
  box-shadow: 0 0 6px rgba(200,168,78,0.4);
}

.mt-die-fail {
  background: rgba(204,34,34,0.25) !important;
  border-color: var(--color-blood-bright) !important;
  color: var(--color-blood-bright) !important;
}

.mt-die-more {
  font-size: 9px;
  color: var(--color-faded);
}

.mt-eq {
  color: var(--color-dim);
  font-size: 10px;
}

.mt-total {
  font-family: var(--font-cinzel);
  font-size: 14px;
  font-weight: 900;
  color: var(--color-bone);
}

.mt-total-big {
  font-family: var(--font-cinzel);
  font-size: 18px;
  font-weight: 900;
  color: var(--color-bone);
  flex-shrink: 0;
}

.mt-total-crit {
  color: var(--color-gold-bright) !important;
  text-shadow: 0 0 8px rgba(232,208,104,0.5);
}

.mt-total-fail {
  color: var(--color-blood-bright) !important;
}

/* ── HP bar ───────────────────────────────────────────────── */

.mt-hp {
  position: relative;
  width: 50px;
  height: 10px;
  border-radius: 5px;
  overflow: hidden;
  background: rgba(0,0,0,0.3);
  border: 1px solid rgba(255,255,255,0.08);
  flex-shrink: 0;
}

.mt-hp-fill {
  position: absolute;
  left: 0; top: 0; bottom: 0;
  border-radius: 5px;
  transition: width 0.5s ease;
}

.mt-hp-dmg {
  background: linear-gradient(90deg, #cc2222, #881414);
}

.mt-hp-heal {
  background: linear-gradient(90deg, #22cc44, #118822);
}

.mt-hp-txt {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-cinzel);
  font-size: 7px;
  font-weight: 700;
  color: #fff;
  text-shadow: 0 1px 2px rgba(0,0,0,0.8);
}

/* ── Badge ────────────────────────────────────────────────── */

.mt-badge {
  position: absolute;
  top: -2px;
  right: -2px;
  font-family: var(--font-cinzel);
  font-size: 7px;
  font-weight: 700;
  padding: 2px 5px;
  border-radius: 4px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.mt-badge-crit {
  background: var(--color-gold);
  color: var(--color-abyss);
  box-shadow: 0 0 8px rgba(232,208,104,0.5);
  animation: mt-badge-pulse 0.8s ease-out;
}

.mt-badge-fail {
  background: var(--color-blood-bright);
  color: #fff;
}

@keyframes mt-badge-pulse {
  0% { transform: scale(0); }
  50% { transform: scale(1.3); }
  100% { transform: scale(1); }
}

/* ── Progress ─────────────────────────────────────────────── */

.mt-progress {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--color-gold-dark), var(--color-gold));
  width: 100%;
  transform-origin: left;
  animation: mt-progress-shrink 4s linear forwards;
  opacity: 0.5;
}

@keyframes mt-progress-shrink {
  from { transform: scaleX(1); }
  to { transform: scaleX(0); }
}

.mt-crit .mt-progress {
  background: linear-gradient(90deg, var(--color-gold), var(--color-gold-bright));
  opacity: 0.8;
}

.mt-fail .mt-progress {
  background: linear-gradient(90deg, var(--color-blood), var(--color-blood-bright));
}
